---
output:
  pdf_document:
    keep_tex: yes
    fig_caption: yes
    toc: no
  html_document:
    toc: no
    df_print: paged
fontsize: 12pt
header-includes:
- \usepackage{setspace}\doublespacing
- \usepackage{float}
- \usepackage{caption}

---
\captionsetup[figure]{labelformat=empty}
\captionsetup[table]{labelformat=empty}
\renewcommand{\figurename}{}

# Supporting information:

# Recipient and donor characteristics govern the hierarchical structure of heterospecific pollen competition networks

__Authors:__ Jose B. Lanuza, Ignasi Bartomeus, Tia-Lynn Ashman, Romina Rader

The following Supporting Information is available for this article:

__Table S1.__ Species names, common names, varieties and sources of the different seeds.

__Table S2.__ Trait measurements for all species.

__Table S3.__ Average number of pollen grains of the recipient and donor species per stigma with the 50:50 mix CP:HP pollen.

__Table S4.__ Seed:ovule ratio (%) of the different reproductive biology treatments.

__Table S5.__ Summary of the effect from the linear models of the different pollen donors on each recipient species.

__Table S6.__ Estimates, standard error, t-value and _P_-value of the effect of the different 9 donors on each recipient species.

__Table S7.__ Total number of seeds produced with the 100% foreign pollen treatments.

__Table S8.__ Procrustes analysis results.

__Table S9.__ Phylogenetic signal and significance for all the different traits.


__Figure S1__. Average number of pollen grains of recipient and donor species per stigma with the 50:50 mix CP:HP pollen.

__Figure S2__. Average proportion (%) of conspecific and heterospecific pollen per stigma with the 50:50 mix CP:HP pollen.

__Figure S3__. Average proportion (%) of heterospecific and conspecific pollen per stigma and family with the 50:50 mix CP:HP pollen.

__Figure S4__. Statistical comparison of the percentage of heterospecific pollen with the 50:50 pollen mix by family.

__Figure S5__. Unipartite bidirectional network with asymmetrical effect.

__Figure S6__. Correlation matrix for all the different traits.

__Figure S7__. Species reproductive biology.

__Figure S8__. Grouped effect sizes by family for each recipient species.



\newpage

```{r, echo=FALSE, warning=FALSE, fig.align="center", out.width='80%'}
library(knitr)
library(kableExtra)
Species <- c("Brassica oleracea", "Brassica rapa", "Eruca sativa", "Sinapis alba", "Ipomoea aquatica", "Ipomoea purpurea", "Capsicum annuum", "Petunia integrifolia", "Solanum lycopersicum", "Solanum melongena")
Species <- as.character(Species)
  
Common_names <- c("Wild cabbage", "Pak choi", "Rocket", "White mustard", "Water spinach", "Morning glory", "Capsicum", "Petunia", "Tomato", "Eggplant")
Common_names <- as.character(Common_names)
Variety <- c("Capitata", "Chinensis", "", "", "", "", "California Wonder", "", "Tommy Toe", "Little Fingers") 
Variety <- as.character(Variety)
Source <- c("https://www.mrfothergills.com.au/", "https://www.mrfothergills.com.au/", "https://www.mrfothergills.com.au/", "https://www.mrfothergills.com.au/", "https://www.theseedcollection.com.au/", "http://www.shaman-australis.com.au", "https://www.edenseeds.com.au", "https://www.dianeseeds.com/", "https://www.mrfothergills.com.au/", "https://www.4seasonsseeds.com.au/")
Source <- as.character(Source)
t <- data.frame(Species, Common_names, Variety, Source)
colnames(t) <- c("Species", "Common names", "Varieties", "Source")
kable(t, format = "latex", longtable = T, booktabs = T,linesep = "\\addlinespace",
             caption = "\\textbf{Table S1.} Species names, common names, varieties and sources of the different seeds.") %>%
  kable_styling(latex_options = c("repeat_header","striped"), font_size = 10, full_width=T) %>% row_spec(0,bold=TRUE)  %>%
  column_spec(1,italic =T)
```

\begin{landscape}


```{r, echo=FALSE, warning=FALSE, fig.align="center", out.width='80%'}
library(kableExtra)

dat <- readRDS("Tables/traits_supplementary.rds")
#Convert to square mm and mm
dat$stigma_area <- dat$stigma_area/1000000
dat[,c(7:12)] <- dat[,c(7:12)]/1000

colnames(dat) <- c("Species", "Pollen size $\\mu$m", "Pollen grains per anther", "Ovule number", "Pollen:ovule ratio", "Stigma area $\\mu$m$^{2}$", "Stigma length (mm)", "Stigma width (mm)", "Style length (mm)", "Style width (mm)", "Ovary length (mm)", "Ovary width (mm)", "Selfing rate", "SI index")



kable(dat, "latex", longtable = F, caption = "\\textbf{Table S2.} Average values of the trait measurements for each plant species. Sample sizes are provided on the methods section. Detailed information of how pollen:ovule ratio, selfing rate and SI index were calculated is available in the plant functional traits section from the methods. The raw data can be found on the online repository provided within this manuscript.", escape = FALSE,digits=2,booktabs = T,linesep = "\\addlinespace") %>% kable_styling(font_size = 6, full_width=T,latex_options = c("striped","scale_down")) %>% row_spec(0,bold=TRUE)  %>% column_spec(1, width = "2cm")%>%column_spec(1,italic =T)
```

\end{landscape}


\newpage


```{r, echo=FALSE, warning=FALSE, fig.align="center", out.width='80%'}
library(kableExtra)
dat <- readRDS("Tables/total_pollen.rds")
dat <- dat[,-5]
colnames(dat) <- c("Recipient species", "Donor species", "Recipient pollen grains", "Donor pollen grains")
  
kable(dat, "latex", longtable = F, caption = "\\textbf{Table S3.} Average recipient and donor pollen grains per stigma with the 50:50 mix CP:HP pollen for the subset of 20 counts (3 replicates per treatment).", escape = FALSE,booktabs = T,linesep = "\\addlinespace")%>% kable_styling(font_size = 10, full_width=T,latex_options = c("striped","scale_down"))%>%column_spec(1,italic =T)%>%column_spec(2,italic =T) %>% row_spec(0,bold=TRUE) 

```

\newpage


```{r, echo=FALSE, warning=FALSE, fig.align="center", out.width='80%'}
library(kableExtra)
dat <- readRDS("Tables/rep_biology_supplementary.rds")

kable(dat, "latex", longtable = F, caption = "\\textbf{Table S4.} Results of the test of hand cross-pollination, hand self-pollination, spontaneous selfing and apomixis for all species. The values provided are the seed:ovule ratios in percentage.", escape = FALSE,digits=2,booktabs = T,linesep = "\\addlinespace") %>% kable_styling(font_size = 10, full_width=T,latex_options = c("striped","scale_down")) %>% row_spec(0,bold=TRUE)  %>% column_spec(1, width = "3cm")%>%column_spec(1,italic =T)


```



\begin{landscape}


```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE}
setwd("~/R_projects/Hp_pollen_experiment")
d <- read.csv("Data/Csv/Significant_Effect_50_50.csv")
#Unfortunately this table is not built through clean reproducible code
#Our collaborators do not work with markdown and some plots were made directly in word
#I have converted that table to csv and exported in R
#To reproduce it, the file hp_seed_set_reduction in the folder analysis has everything
#that is needed to make this table

d <- as.data.frame(d)
d <- d[,-12]
d[11,12] <- "$\\bar{X}=67.8$"
colnames(d) <- c("", "Brassica oleracea", "Brassica rapa", "Eruca sativa", "Sinapis alba", "Ipomoea aquatica", "Ipomoea purpurea", "Capsicum annuum", "Petunia integrifolia", "Solanum lycopersicum", "Solanum melongena", "$\\%$ of significant effect")

kable(d, "latex", longtable = F, caption= "\\textbf{Table S5.} Summary of the heterospecific pollen impacts from the linear models on each pollen recipient species. The category of “yes” represents a significant effect of the pollen donor (columns) on the recipient species (rows) and the category of “no” represents a lack of significant seed set reduction in comparison with the control treatment. Significance was tested for each species by comparing the different 50-50 CP-HP pollen treatments with the control treatment of hand cross-pollination with conspecific pollen.", escape = FALSE,digits=2,booktabs = T,linesep = "\\addlinespace") %>% kable_styling(font_size = 6, full_width=T,latex_options = c("striped","scale_down")) %>% row_spec(0,bold=FALSE)  %>% column_spec(1, width = "2cm")%>% column_spec(10, width = "1.5cm")%>%column_spec(1,italic =T) %>% row_spec(0,italic =T)
```

\end{landscape}

\clearpage

```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE}
library(kableExtra)
setwd("~/R_projects/Hp_pollen_experiment")
d <- readRDS("Data/RData/lm_table.RData")
#kable(d, format="latex",caption= "\\textbf{Table S6.} Output of linear models of the effect of the different donors on the seed set of each recipient species.", digits = 2)

colnames(d) <- c("Estimates", "Standard error", "t-value", "{\\textit{P}}-value")

kable(d, "latex", longtable = T, digits=2, escape=F,booktabs = T,linesep = "\\addlinespace",caption= "\\textbf{Table S6.} Results of the linear models conducted to test the effect of heterospecific pollen with the 50-50 CP-HP pollen treatments. We conducted 10 different linear models (M1, M2, M3, M4, M5, M6, M7 M8, M9 and M10) where the effect of the different 9 pollen donors was compared with the control treatment of hand cross pollination with conspecific pollen for each recipient species (intercept). The first species on the row names are the pollen recipient species and the second species the pollen donor species. Each treatment is compared with the control or reference treatment that is indicated with the recipient species names and the intercept term between parentheses.") %>%
  kable_styling(latex_options = c("striped"), font_size = 7, full_width=F)%>%column_spec(1,italic =T)%>% row_spec(0,bold=TRUE)
```

\clearpage


```{r, echo=FALSE, warning=FALSE, fig.align="center", out.width='80%'}
setwd("~/R_projects/Hp_pollen_experiment")

library(kableExtra)

#Preparing seed set with 100% pollen
pein_seed_set_100 <- read.csv("Raw_data/pein_seed_set_100.csv")
soly_seed_set_100 <- read.csv("Raw_data/soly_seed_set_100.csv")
some_seed_set_100 <- read.csv("Raw_data/some_seed_set_100.csv")
caan_seed_set_100 <- read.csv("Raw_data/caan_seed_set_100.csv")
brol_seed_set_100 <- read.csv("Raw_data/brol_seed_set_100.csv")
brra_seed_set_100 <- read.csv("Raw_data/brra_seed_set_100.csv")
sial_seed_set_100 <- read.csv("Raw_data/sial_seed_set_100.csv")
ersa_seed_set_100 <- read.csv("Raw_data/ersa_seed_set_100.csv")
ippu_seed_set_100 <- read.csv("Raw_data/ippu_seed_set_100.csv")
ipaq_seed_set_100 <- read.csv("Raw_data/ipaq_seed_set_100.csv")


all_100 <- rbind(pein_seed_set_100,soly_seed_set_100,some_seed_set_100,caan_seed_set_100,
      brol_seed_set_100,brra_seed_set_100,sial_seed_set_100,ersa_seed_set_100,
      ippu_seed_set_100,ipaq_seed_set_100)

all_100_subset <- all_100[grepl("100", all_100$Treatment), , drop = FALSE]

seed_100 <- subset(all_100_subset, all_100_subset$Seed.production>0)
#str(seed_100)
seed_100$Species <- as.character(seed_100$Species)
seed_100$Species[seed_100$Species=="SOLY"] <- "Solnamum lycopersicum"
seed_100$Species[seed_100$Species=="SOME"] <- "Solnamum melongena"
seed_100$Species[seed_100$Species=="CAAN"] <- "Capsicum annuum"
seed_100$Species[seed_100$Species=="BRRA"] <- "Brassica rapa"
seed_100$Species[seed_100$Species=="SIAL"] <- "Sinapis alba"
seed_100$Species[seed_100$Species=="ERSA"] <- "Eruca sativa"

seed_100$Treatment <- as.character(seed_100$Treatment)

seed_100$Treatment[seed_100$Treatment=="SIAL 100%"] <- "Sinapis alba"
seed_100$Treatment[seed_100$Treatment=="ERSA 100%"] <- "Eruca sativa"
seed_100$Treatment[seed_100$Treatment=="PEIN 100%"] <- "Petunia integrifolia"
seed_100$Treatment[seed_100$Treatment=="BROL 100%"] <- "Brassica oleracea"
seed_100$Treatment[seed_100$Treatment=="CAAN 100%"] <- "Capsicum annuum"
seed_100$Treatment[seed_100$Treatment=="SOLY 100%"] <- "Solanum lycopersicum"

seed_100 <- seed_100[,-c(1,4,6)]
colnames(seed_100) <- c("Recipient", "Donor (100% foreign pollen)", "Seed number")
rownames(seed_100) <- NULL

seed_100 <- as.data.frame(seed_100)

kable(seed_100, "latex", longtable = F,digits=2,booktabs = T, linesep = "\\addlinespace", caption= "\\textbf{Table S7.} Number of seeds produced with the 100\\% foreign pollen treatments (N=900). From 900 pollination events we found seed production in just 13 specific cases and 0 seed production in the other 887 pollination events. In this table we show just the treatments that lead to seed production.") %>% kable_styling(font_size = 10,position="left",full_width=F,latex_options = c("striped","scale_down")) %>% row_spec(0,bold=TRUE)  %>%
   add_footnote("*            Note: There are some specific cases that we think that hybridization did not occur and that the recipient species were pollen contaminated, like the one of C. annuum with S. alba with 127 seeds. This seems to be the case for 5 other crosses that had very low seed production when they were pollinated with 100% foreign pollen with species of other family members. This represents very few isolated cases (0.67% of all the 100% foreign pollen crosses conducted) and we think that our results are not compromised by this fact. ", notation = "none") %>% column_spec(1,italic =T)%>% column_spec(2,italic =T)


```



\clearpage


```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE,  out.width='40%'}

library(kableExtra)
setwd("~/R_projects/Hp_pollen_experiment")
load("Data/RData/img_phylo.RData")
lambda <- c( selfing[1], pollen_size[1], mean_pollen_anther[1], mean_ovules[1], pollen_ovule_ratio[1], stigma_area[1], stigma_length[1], stigma_width[1], style_length[1], style_width[1], ovary_length[1], ovary_width[1],si_index[1])
lambda<- as.numeric(lambda)
p <- c(selfing[4], pollen_size[4], mean_pollen_anther[4], mean_ovules[4], pollen_ovule_ratio[4], stigma_area[4], stigma_length[4], stigma_width[4], style_length[4], style_width[4], ovary_length[4], ovary_width[4], si_index[4])
p <- as.numeric(p)
trait <- c("Selfing rate", "Pollen size", "Pollen anther", "Ovule number", "Pollen-ovule ratio", "Stigmatic area", "Stigma length", "Stigma width", "Style length", "Style width", "Ovary length", "Ovary width", "SI index")
table<- data.frame(lambda,p, trait)
colnames(table) <- c("Lambda", "P-value", "Traits")
#kable(table, format="latex",caption= "\\textbf{Table S7.} Phylogenetic signal and significance for all the different traits.", digits = 2)


kable(table, format="latex",escape=F,digits=2, longtable = F,booktabs = T,linesep = "\\addlinespace", caption= "\\textbf{Table S8.} Phylogenetic signal and significance for the 13 different reproductive traits measured for all species.") %>% kable_styling(font_size = 10, full_width=F,latex_options = c("striped")) %>% row_spec(0,bold=TRUE)  


```

\clearpage


```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE}
library(kableExtra)
setwd("~/R_projects/Hp_pollen_experiment")

load("Data/RData/Table_s4.RData")

Correlation <- c(selfing_pro[6], pollen_size_pro[6], mean_pollen_anther_pro[6], mean_ovules_pro[6], pollen_ovule_ratio_pro[6], stigma_area_pro[6], stigma_length_pro[6], stigma_width_pro[6], style_length_pro[6], style_width_pro[6], ovary_width_pro[6], ovary_length_pro[6], si_index_pro[6],selfing_pro_sol[6], pollen_size_pro_sol[6], mean_pollen_anther_pro_sol[6], mean_ovules_pro_sol[6], pollen_ovule_ratio_pro_sol[6], stigma_area_pro_sol[6], stigma_length_pro_sol[6], stigma_width_pro_sol[6], style_length_pro_sol[6], style_width_pro_sol[6], ovary_width_pro_sol[6], ovary_length_pro_sol[6], si_index_pro_sol[6],selfing_pro_bra[6], pollen_size_pro_bra[6], mean_pollen_anther_pro_bra[6], mean_ovules_pro_bra[6], pollen_ovule_ratio_pro_bra[6], stigma_area_pro_bra[6], stigma_length_pro_bra[6], stigma_width_pro_bra[6], style_length_pro_bra[6], style_width_pro_bra[6], ovary_width_pro_bra[6], ovary_length_pro_bra[6], si_index_pro_bra[6])



Correlation<- as.numeric(Correlation)


Sum_squares <- c(selfing_pro[3], pollen_size_pro[3], mean_pollen_anther_pro[3], mean_ovules_pro[3], pollen_ovule_ratio_pro[3], stigma_area_pro[3], stigma_length_pro[3], stigma_width_pro[3], style_length_pro[3], style_width_pro[3], ovary_width_pro[3], ovary_length_pro[3],si_index_pro[3], selfing_pro_sol[3], pollen_size_pro_sol[3], mean_pollen_anther_pro_sol[3], mean_ovules_pro_sol[3], pollen_ovule_ratio_pro_sol[3], stigma_area_pro_sol[3], stigma_length_pro_sol[3], stigma_width_pro_sol[3], style_length_pro_sol[3], style_width_pro_sol[3], ovary_width_pro_sol[3], ovary_length_pro_sol[3],si_index_pro_sol[3], selfing_pro_bra[3], pollen_size_pro_bra[3], mean_pollen_anther_pro_bra[3], mean_ovules_pro_bra[3], pollen_ovule_ratio_pro_bra[3], stigma_area_pro_bra[3], stigma_length_pro_bra[3], stigma_width_pro_bra[3], style_length_pro_bra[3], style_width_pro_bra[3], ovary_width_pro_bra[3], ovary_length_pro_bra[3],si_index_pro_bra[3])


Sum_squares<- as.numeric(Sum_squares)

Significance <- c(selfing_pro[13], pollen_size_pro[13], mean_pollen_anther_pro[13], mean_ovules_pro[13], pollen_ovule_ratio_pro[13], stigma_area_pro[13], stigma_length_pro[13], stigma_width_pro[13], style_length_pro[13], style_width_pro[13], ovary_width_pro[13], ovary_length_pro[13],si_index_pro[13],selfing_pro_sol[13], pollen_size_pro_sol[13], mean_pollen_anther_pro_sol[13], mean_ovules_pro_sol[13], pollen_ovule_ratio_pro_sol[13], stigma_area_pro_sol[13], stigma_length_pro_sol[13], stigma_width_pro_sol[13], style_length_pro_sol[13], style_width_pro_sol[13], ovary_width_pro_sol[13], ovary_length_pro_sol[13],si_index_pro_sol[13], selfing_pro_bra[13], pollen_size_pro_bra[13], mean_pollen_anther_pro_bra[13], mean_ovules_pro_bra[13], pollen_ovule_ratio_pro_bra[13], stigma_area_pro_bra[13], stigma_length_pro_bra[13], stigma_width_pro_bra[13], style_length_pro_bra[13], style_width_pro_bra[13], ovary_width_pro_bra[13], ovary_length_pro_bra[13],si_index_pro_bra[13])


Significance <- as.numeric(Significance)


Trait <- c("Selfing rate", "Pollen size", "Pollen per anther", "Number of ovules", "Pollen-ovule ratio", "Stigmatic area", "Stigma length", "Stigma width", "Style length", "Style width","Ovary length","Ovary width", "Self-incompatibility index", "Selfing rate", "Pollen size", "Pollen per anther", "Number of ovules", "Pollen-ovule ratio", "Stigmatic area", "Stigma length", "Stigma width", "Style length", "Style width","Ovary length","Ovary width", "Self-incompatibility index", "Selfing rate", "Pollen size", "Pollen per anther", "Number of ovules", "Pollen-ovule ratio", "Stigmatic area", "Stigma length", "Stigma width", "Style length", "Style width","Ovary length","Ovary width", "Self-incompatibility index")

Family <- c(rep("All",13),rep("Solanaceae",13),rep("Brassicaceae",13))

table<- data.frame(Correlation,Sum_squares, Significance,Trait,Family)

colnames(table) <- c("Correlation (r)","Sum of squares", "P-value", "Traits", "Family")

kable(table, "latex", longtable = T, digits=2, escape=F,booktabs = T,linesep = "\\addlinespace",caption= "\\textbf{Table S9.} Procrustes correlation, sum of squares and significance from Procrustes analysis between the matrix of effect sizes (species x species matrix) and the distance matrix of each trait for all families, just Solanaceae family and just Brassicaceae family.") %>%
  kable_styling(latex_options = c("striped"), font_size = 7, full_width=F)%>% row_spec(0,bold=TRUE)

```


\clearpage


\clearpage

```{r, echo=FALSE, message=FALSE, warning=FALSE,cache=FALSE,fig.height=6 ,fig.width=7, fig.cap="**Fig. S1** Average number of pollen grains per stigma for 20 different treatments (3 replicates per tratment). For each treatment, we show the average number of conspecific pollen grains (grey) and heterospecific pollen grains (light blue) per stigma. For each pair of species on the x-axis, the first species is the recipient species, and the second, the donor species."}

library(ggplot2)

setwd("~/R_projects/Hp_pollen_experiment")
total_pollen <- read.csv("Data/Csv/total_pollen.csv")
ggplot(total_pollen, aes(x=spp, y=ratio, fill=variable,width=.9)) +
  geom_bar(stat='identity', position='dodge')+theme_light()+ 
  theme(legend.title = element_blank(),axis.text.x=element_text(angle=60,hjust=1,face="italic"))+
  scale_fill_manual(values=c("#999999","#779799"),labels = c("Conspecific pollen","Heterospecific pollen"))+labs(x = "",y="Pollen grains per stigma")

```


\clearpage


```{r, echo=FALSE, message=FALSE, warning=FALSE,cache=FALSE,fig.height=7,fig.width=7, fig.cap="**Fig. S2** Average proportion of conspecific and heterospecific pollen per stigma grouped by family, A) Brassicaceae, B) Solanaceae and C) Convolvulaceae. These proportions (%) are the number of conspecific pollen grains or heterospecific pollen grains divided by the total number of pollen grains per stigma for 20 different treatments. We conducted 3 count replicates per treatment and then we calculated the average number of pollen grains for these treatments. The proportion of conspecific and heterospecific pollen are shown in grey and light blue respectively. For each pair of species on the y-axis, the first species is the pollen recipient and the second the pollen donor. The vertical black line represents 50% pollen of both donor and recipient."}

par(mar=c(2,13,2,4),xpd=F)
par(mfrow=c(3,1))
setwd("~/R_projects/Hp_pollen_experiment")
ratio_bra <-readRDS("Data/RData/ratio_bra.RData")
coul = c("#999999","#779799")
barplot(ratio_bra,hor=T, xlim=c(-1,100),ylim=c(-2,7),width = 0.5,col=coul ,space=0.5,border="white",srt=80,las=1,cex.axis=1,cex.names=1,font=3,names=c("E. sativa-I. purpurea", "B. oleracea-I. purpurea","B. rapa-I. purpurea", "S. alba-I. aquatica", "S. alba-S. melongena", "E. sativa-P. integrifolia", "B. rapa-S. lycopersicum", "B. oleracea-C. annuum"))
abline(v=50,col="black")
legend(-1,-0.1,legend=c("Conspecific pollen","Heterospecific pollen"),bty="n",fill = coul)
text(8.3,6.8,"A) Brassicaceae")
ratio_con <-readRDS("Data/RData/ratio_con.RData")
barplot(ratio_con,hor=T, xlim=c(-1,100),ylim=c(-2,5),width = 0.5,col=coul ,space=0.5,border="white",srt=80,las=1,cex.axis=1,cex.names=1,font=3,names=c("I. purpurea-S. melongena","I. aquatica-C. annuum","I. purpurea-E. sativa","I. aquatica-S. alba"))
abline(v=50,col="black")
legend(-1,-0.5,legend=c("Conspecific pollen","Heterospecific pollen"),bty="n",fill = coul)
text(9,3.5,"B) Convolvulaceae")

ratio_sol <-readRDS("Data/RData/ratio_sol.RData")
barplot(ratio_sol,hor=T, xlim=c(-1,100),ylim=c(-2,7),width = 0.5,col=coul ,space=0.5,border="white",srt=80,las=1,cex.axis=1,cex.names=1,font=3,names=c("C. annuum-I. purpurea", "S. melongena-I. aquatica", "P. integrifolia-I. aquatica", "S. lycopersicum-I aquatica","S. melongena-E. sativa", "P. integrifolia-E. sativa", "C. annuum-S. alba", "S. lycopersicum-B. rapa"))
abline(v=50,col="black")
legend(-1,-0.1,legend=c("Conspecific pollen","Heterospecific pollen"),bty="n",fill = coul)
text(6.8,6.8,"C) Solanaceae")

```

\clearpage


```{r, echo=FALSE, message=FALSE, warning=FALSE,cache=FALSE,fig.height=4.5,fig.width=5,  fig.cap="**Fig. S3** Average proportion (%) of heterospecific and conspecific pollen per family for the different 20 treatments counted. We conducted 3 count replicates per treatment and then we calculated the average number of pollen grains for these different 20 treatments. Finally, we grouped by family these treatments in order to see general tendencies across families as pollen donor and as pollen recipient. Pollen ratios were considered as the number of conspecific or heterospecific pollen grains divided by the total number of pollen grains per stigma. On the y-axis, the first family on each pair of plant families is the recipient one, and the second, the family of the donor. The vertical bar on intercept 50, represents equal proportions of both recipient (grey) and donor (light blue) pollen."}

par(mar=c(2,8.7,2,2),xpd=F)
setwd("~/R_projects/Hp_pollen_experiment")
data_percentage <-readRDS("Data/RData/per.RData")
data_percentage=as.matrix(data_percentage)
coul = c("#999999","#779799")
barplot(data_percentage,hor=T, xlim=c(-1,100),ylim=c(-2,5),width = 0.5,col=coul ,space=0.5, border="white",srt=80,las=1,cex.axis=0.85,cex.names=0.65,names=c("Brassicaceae-Convolvulaceae",
 "Brassicaceae-Solanaceae","Convolvulaceae-Brassicaceae","Convolvulaceae-Solanaceae","Solanaceae-Convolvulaceae","Solanaceae-Brassicaceae"))
legend(0,-0.5,legend=c("Conspecific pollen","Heterospecific pollen"),bty="n",fill = coul, cex = 0.65)
abline(v=50,col="black")

#lines(c(0,10),50,col="red")
```


\clearpage


```{r, echo=FALSE, message=FALSE, warning=FALSE,cache=FALSE,fig.height=6,fig.width=12,  fig.cap="**Fig. S4** Pollen ratios comparisons between the different pollen recipient families. The boxes represent least square means, the error bars confidence intervals 95% and sharing numbers indicate no significant differences between groups (Tukey adjusted comparisons). These pollen ratios (%) are the total number of heterospecific pollen grains divided by the total quantity of pollen (conspecific pollen + heterospecific pollen). Brassicacea family is coloured in blue, Convolvulaceae in green and Solanaceae in orange."}


#Here I try to compare the different proportions of pollen between the different groups
#I use Tukey method

library(lme4)
library(emmeans)
library(reshape2)
library(multcompView)
library(lsmeans)
library(multcomp)
library(ggplot2)
library(DHARMa)
setwd("~/R_projects/Hp_pollen_experiment")

total_pollen <- read.csv("Data/Csv/total_pollen.csv")

total_pollen=total_pollen[,-1]
colnames(total_pollen)[3] <- "pollen"
#head(total_pollen)


# Dividing by focal pollen and non focal pollen
# In order to compare pollen as donor and recipient per family 
pollen_foc <- subset(total_pollen, variable=="focal_pollen")
pollen_non <- subset(total_pollen, variable=="non_focal_pollen")

total  <- as.numeric(pollen_foc$pollen) + as.numeric(pollen_non$pollen)
pollen_non$total_pollen  <- total
pollen_non$fam_non <- c(rep("Convolvulaceae", 8), rep("Solanaceae", 6), rep("Brassicaceae", 6))
pollen_non$fam_foc <- c("Solanaceae","Brassicaceae","Brassicaceae","Brassicaceae","Solanaceae",
                        "Solanaceae","Solanaceae","Brassicaceae","Convolvulaceae","Brassicaceae",
                        "Brassicaceae", "Brassicaceae", "Convolvulaceae", "Brassicaceae", "Convolvulaceae", "Solanaceae",
                        "Solanaceae", "Convolvulaceae","Solanaceae","Solanaceae")

pollen_non <- pollen_non[,-c(1,2)]
colnames(pollen_non)[1] <-"hp_pollen"
pollen_non$hp_ratio <- as.numeric(pollen_non$hp_pollen)/as.numeric(pollen_non$total_pollen)
#hist(pollen_non$hp_ratio)

pollen_foc$total_pollen  <- total
pollen_foc$fam_non <- c(rep("Convolvulaceae", 8), rep("Solanaceae", 6), rep("Brassicaceae", 6))
pollen_foc$fam_foc <- c("Solanaceae","Brassicaceae","Brassicaceae","Brassicaceae","Solanaceae",
                        "Solanaceae","Solanaceae","Brassicaceae","Convolvulaceae","Brassicaceae",
                        "Brassicaceae", "Brassicaceae", "Convolvulaceae", "Brassicaceae", "Convolvulaceae", "Solanaceae",
                        "Solanaceae", "Convolvulaceae","Solanaceae","Solanaceae")

pollen_foc <- pollen_foc[,-c(1,2)]
colnames(pollen_foc)[1] <-"hp_pollen"
pollen_foc$hp_ratio <- as.numeric(pollen_foc$hp_pollen)/as.numeric(pollen_foc$total_pollen)
#hist(pollen_foc$hp_ratio)


#Analyse data and plot it

junk.glmer = lm(hp_ratio ~ fam_non, data = pollen_non)
#plot(junk.glmer)
#goodness of fit of the model
#testDispersion(junk.glmer)
#simulationOutput <- simulateResiduals(fittedModel = junk.glmer, plot = T)

#lsm = lsmeans(junk.glmer, "fam_non", type = "response")
#pairs(lsm)
#CLD <- CLD(lsm,alpha=0.05,adjust="tukey")

#ggplot(CLD,aes(x= fam_non,y= lsmean,
#label = .group)) +theme_minimal()+
#geom_point(shape  = 15,size   = 4) +ggtitle("B) Comparison of ratios as donor")+
#geom_errorbar(aes(ymin  =  lower.CL,ymax  =  upper.CL),
#width =  0.2,size =  0.7)+ylab("Least square mean")+xlab("Families")+
#geom_text(nudge_x = c(0, 0, 0), nudge_y = c(0.8, 0.8, 0.8),color   = "black")


#Analyse data and plot it
junk.glmer = lm(hp_ratio ~ fam_foc, data = pollen_foc)
lsm = lsmeans(junk.glmer, "fam_foc", type = "response")
#pairs(lsm)
CLD <-  multcomp::cld(lsm,alpha=0.05,adjust="tukey")

#theme
theme_ms <- function(base_size=12, base_family="Helvetica") {
  library(grid)
  (theme_bw(base_size = base_size, base_family = base_family)+
      theme(text=element_text(color="black"),
            axis.title=element_text( size = rel(1.3)),
            axis.text=element_text(size = rel(1), color = "black"),
            legend.title=element_text(face="bold"),
            legend.text=element_text(),
            legend.background=element_rect(fill="transparent"),
            legend.key.size = unit(0.8, 'lines'),
            panel.border=element_rect(color="black",size=1),
            panel.grid.minor.x =element_line(),
            panel.grid.minor.y= element_blank()
      ))
}

ggplot(CLD,aes(x= fam_foc,y= lsmean,
               label = .group)) +theme_ms()+
  geom_point(data = CLD, aes(x = fam_foc, y = lsmean, color = fam_foc),shape  = 15,size   = 4) +
scale_color_manual(name = "Families",values = c("Convolvulaceae" = "#009E73", "Solanaceae" = "#D55E00", "Brassicaceae" = "#0072B2"))+ggtitle("")+
  geom_errorbar(aes(ymin  =  lower.CL,ymax  =  upper.CL,  color = fam_foc),
                width =  0.2,size =  0.9)+ylab("Least square mean")+xlab("Families")+
  geom_text(nudge_x = c(0, 0, 0), nudge_y = c(0.8, 0.8, 0.8),color   = "black") + theme(legend.position = "none")




```


\newpage

```{r, echo=FALSE, message=FALSE, warning=FALSE,cache=FALSE,fig.height=12,fig.width=12,  fig.cap="**Fig. S5** Unipartite bidirectional network with asymmetrical effect. The lines with the arrow heads connect the impact of foreign pollen (effect size) of each pollen donor species on each recipient species. All the arrow heads point to the recipient species of the reciprocal interaction. Lines of species that did not have a negative impact are not represented. The different nodes and the effect of the donor species on the recipient species appear coloured by family: Solanaceae (orange), Brassicaceae (blue) and Convolvulaceae (green). The intensity of the effect is represented by the line´s size where a larger effect size corresponds to a thicker line and a thinner line to a smaller effect size. Species code: BROL: Brassica oleracea, BRRA: Brassica rapa, ERSA: Eruca sativa, SIAL: Sinapis alba, IPAQ: Ipomoea aquatica, IPPU: Ipomoea purpurea, CAAN: Capsicum annuum, PEIN: Petunia integrifolia, SOLY: Solanum lycopersicum, SOME: Solanum melongena."}

library(statnet)
library(reshape2)
library(sna)
library(igraph)
setwd("~/R_projects/Hp_pollen_experiment")

#######################################
############ Data preparataion ########
#######################################

#In this script I'm going to plot the transitivity of the effect oh HP pollen with effect sizes
effect <- readRDS("Data/RData/matrix_effect_size.RData")
#Now I convert the few values over 0 to maximum 0 (control)
effect[effect>0]<-0
#absolute values so less confusing without negative values
#So now greater values involve greater effect
#(opposite way in comparison with negative values as before)
effect=abs(effect)
#UNIPARTITE DOUBLE ASSYMETRICAL EFFECT
G <- graph.adjacency(t(effect),weighted=TRUE,diag=FALSE)
#plot(G)
E <- t(apply(get.edgelist(G),1,sort))
E(G)$curved <- 0
E(G)[duplicated(E) | duplicated(E,fromLast =TRUE)]$curved <- 0.2
plot(G, edge.width=E(G)$weight/0.5,  vertex.color=c(rep("#0072B2",2),"#D55E00","#0072B2", rep("#009E73",2),
              "#D55E00","#0072B2", rep("#D55E00",2)),edge.arrow.size=0.8,edge.color=adjustcolor(c(rep("#0072B2",8),rep("#0072B2",8), rep("#D55E00",7), 
              rep("#0072B2",9),rep("#009E73",7),rep("#009E73",9),rep("#D55E00",7),rep("#0072B2",8), rep("#D55E00",8), rep("#D55E00",7)), alpha.f = .5))


```


\clearpage


```{r, echo=FALSE, message=FALSE, warning=FALSE,cache=FALSE,fig.height=6,fig.width=6, fig.cap="**Fig. S6** Graphical representation of the correlation matrix of all the traits measured. Positive correlations are displayed in blue and negative in red. The intensity, size and colour of the circles are proportional to the correlation coefficient from Pearson’s r."}
#install.packages("corrplot")
library(corrplot)
setwd("~/R_projects/Hp_pollen_experiment")
#Example
#I'm going to try to show our traits on this way
#M <- cor(mtcars)
#corrplot(M, method = "circle")
#We can kill two birds with one stone, showing the correlation and all the traits
traits_all <- read.csv("Data/Csv/traits_all.csv")
si_index <- readRDS("Data/RData/si_index.RData")
traits_all$si_index <- si_index
traits_all=traits_all[,-c(1,2)]
traits_all=traits_all[,-c(1,7,11)]
#Change order of ovary width length I rename below in row and colname
a<-traits_all[,11]
b<-traits_all[,12]
traits_all[,11] <-b
traits_all[,12]<- a
traits_all<- cor(traits_all)

rownames(traits_all)<- c("Selfing rate", "Pollen size", "Pollen grains/anther", "Number of ovules", "Pollen-ovule ratio",
                         "Stigmatic area", "Stigma length", "Stigma width", "Style length", "Style width",
                         "Ovary length", "Ovary width", "SI index")

colnames(traits_all)<- c("Selfing rate", "Pollen size", "Pollen grains/anther", "Number of ovules", "Pollen-ovule ratio",
                "Stigmatic area", "Stigma length", "Stigma width", "Style length", "Style width",
                "Ovary length", "Ovary width", "SI index")
  
#corrplot(traits_all, method = "circle")
#corrplot(traits_all, type = "upper")
par(mar=c(0,4.1,4.1,2.1))
corrplot(traits_all, type = "lower", tl.cex = 0.8, cl.cex = 0.8, tl.col = "black", tl.srt = 45)

#Add Compatibility index!

```



\clearpage


```{r, echo=FALSE, message=FALSE, warning=FALSE,cache=FALSE,fig.height=6.5,fig.width=12,  fig.cap="**Fig. S7** Violin plot of the proportion of seeds coverted to ovule (%) for all species with four different hand-pollination treatments: apomixis (orange), hand cross pollination (green), hand self pollination (blue) and spontaneous selfing (yellow). The species are grouped by family in three different panels that are named with the corresponding family names (Brassicaceae, Convolvulaceae and Solanaceae). The coloured dots, represent the different values of seed:ovule ratio for each treatment."}

setwd("~/R_projects/Hp_pollen_experiment")
#Script to plot the reproductive biology tests
#load libraries
library(ggplot2)
#install.packages("devtools")
library(devtools)
#install_github("easyGgplot2", "kassambara")
library(effsize)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(cowplot)
library(gridExtra)
library(egg)
library(magrittr)
library(multipanelfigure)
library(grid)

brol <- read.csv("Raw_data/brol_seed_set_final.csv")
brra <- read.csv("Raw_data/brra_seed_set_final.csv")
ersa <- read.csv("Raw_data/ersa_seed_set_final.csv")
sial <- read.csv("Raw_data/sial_seed_set_final.csv")
ipaq <- read.csv("Raw_data/ipaq_seed_set_final.csv")
ippu <- read.csv("Raw_data/ippu_seed_set_final.csv")
caan <- read.csv("Raw_data/caan_seed_set_final.csv")
pein <- read.csv("Raw_data/pein_seed_set_final.csv")
soly <- read.csv("Raw_data/soly_seed_set_final.csv")
some <- read.csv("Raw_data/some_seed_set_final.csv")
#loading traits to divide by number of ovules the seed set 
traits <- read.csv("Data/Csv/traits_scinames.csv")


brol_r <- subset(brol, Treatment=="Cross"|Treatment=="Self"|Treatment=="Control"|Treatment=="FC")
brol_r$Seed_set <- brol_r$Seed.production/traits[1,8]*100
brra_r <- subset(brra, Treatment=="Cross"|Treatment=="Self"|Treatment=="Control"|Treatment=="Flower Control")
brra_r$Seed_set <- brra_r$Seed.production/traits[2,8]*100
ersa_r <- subset(ersa, Treatment=="Cross"|Treatment=="Self"|Treatment=="Control"|Treatment=="Flower Control")
ersa_r$Seed_set <- ersa_r$Seed.production/traits[4,8]*100
sial_r <- subset(sial, Treatment=="Cross"|Treatment=="Self"|Treatment=="Control"|Treatment=="Flower Control")
sial_r$Seed_set <- sial_r$Seed.production/traits[8,8]*100
ipaq_r <- subset(ipaq, Treatment=="Cross"|Treatment=="Self"|Treatment=="Control"|Treatment=="Flower control")
ipaq_r$Seed_set <- ipaq_r$Seed.production/traits[5,8]*100
ippu_r <- subset(ippu, Treatment=="Cross"|Treatment=="Self"|Treatment=="Control"|Treatment=="Flower control")
ippu_r$Seed_set <- ippu_r$Seed.production/traits[6,8]*100
caan_r <- subset(caan, Treatment=="CROSS"|Treatment=="SELF"|Treatment=="CONTROL"|Treatment=="FLOWER CONTROL")
caan_r$Seed_set <- caan_r$Seed.production/traits[3,8]*100
pein_r <- subset(pein, Treatment=="CROSS"|Treatment=="SELF"|Treatment=="CONTROL"|Treatment=="FLOWER CONTROL")
pein_r$Seed_set <- pein_r$Seed.production/traits[7,8]*100
soly_r <- subset(soly, Treatment=="Cross"|Treatment=="Self"|Treatment=="Control"|Treatment=="Flower control")
soly_r$Seed_set <- soly_r$Seed.production/traits[9,8]*100
some_r <- subset(some, Treatment=="Cross"|Treatment=="Self"|Treatment=="Control"|Treatment=="Flower control")
some_r$Seed_set <- some_r$Seed.production/traits[10,8]*100

d <- rbind(brol_r,brra_r,ersa_r,sial_r,ipaq_r,ippu_r,caan_r,pein_r,soly_r,some_r)
d$Seed_set[d$Seed_set>100]<-100

#levels(d$Treatment)
d$Treatment=as.character(d$Treatment)
d$Treatment[d$Treatment=="Cross"]<-"Hand cross-pollination"
d$Treatment[d$Treatment=="CROSS"]<-"Hand cross-pollination"
d$Treatment[d$Treatment=="Self"]<-"Hand self-pollination"
d$Treatment[d$Treatment=="SELF"]<-"Hand self-pollination"
d$Treatment[d$Treatment=="SELF"]<-"Hand self-pollination"
d$Treatment[d$Treatment=="Control"]<-"Apomixis"
d$Treatment[d$Treatment=="CONTROL"]<-"Apomixis"
d$Treatment[d$Treatment=="FC"]<-"Spontaneous selfing"
d$Treatment[d$Treatment=="Flower control"]<-"Spontaneous selfing"
d$Treatment[d$Treatment=="FLOWER CONTROL"]<-"Spontaneous selfing"
d$Treatment[d$Treatment=="Flower Control"]<-"Spontaneous selfing"

d$Family=as.character(d$Family)
d$Family[d$Species=="BROL"]<-"Brassicaceae"
d$Family[d$Species=="BRRA"]<-"Brassicaceae"
d$Family[d$Species=="ERSA"]<-"Brassicaceae"
d$Family[d$Species=="SIAL"]<-"Brassicaceae"
d$Family[d$Species=="IPPU"]<-"Convolvulaceae"
d$Family[d$Species=="IPAQ"]<-"Convolvulaceae"
d$Family[d$Species=="SOME"]<-"Solanaceae"
d$Family[d$Species=="SOLY"]<-"Solanaceae"
d$Family[d$Species=="PEIN"]<-"Solanaceae"
d$Family[d$Species=="CAAN"]<-"Solanaceae"

d$Species=as.character(d$Species)
d$Species[d$Species=="BROL"]<-"B. oleracea"
d$Species[d$Species=="BRRA"]<-"B. rapa"
d$Species[d$Species=="SIAL"]<-"S. alba"
d$Species[d$Species=="ERSA"]<-"E. sativa"
d$Species[d$Species=="IPPU"]<-"I. purpurea"
d$Species[d$Species=="IPAQ"]<-"I. aquatica"
d$Species[d$Species=="SOLY"]<-"S. lycopersicum"
d$Species[d$Species=="SOME"]<-"S. melongena"
d$Species[d$Species=="PEIN"]<-"P. integrifolia"
d$Species[d$Species=="CAAN"]<-"C. annuum"

cbPalette <- c( "#56B4E9","#E69F00", "#999999", "#009E73")

ggplot(d, aes(x=Species, y=Seed_set, fill=Treatment)) + 
  geom_violin(scale = "width",draw_quantiles = c(0.5))+
  geom_dotplot(binaxis='y', 
               dotsize=0.15,stackdir='center',position = position_jitterdodge(jitter.width = 0.01))+ facet_grid(. ~ Family,scales="free", space="free")+
  theme_bw()+labs(y="Seed:ovule ratio")+scale_fill_manual(name="Treatments",values=c( "#D55E00","#009E73","#0072B2", "#E69F00"))+theme(plot.title = element_text(face = "bold"),
                                                                                                                                       axis.text.x = element_text(face = "italic"),strip.background = element_rect(color = "black", size = 0.5))


                                         


```




\clearpage



```{r, echo=FALSE, message=FALSE, warning=FALSE,cache=FALSE,fig.height=8,fig.width=7, fig.cap="**Fig. S8** Grouped effect sizes (95% confidence intervals) of the different families on each focal species. For each species, the grouped effect by family is compared with the control treatment of hand cross pollination with conspecific pollen. The control treatment is represented in yellow and vertically intersected with a dashed line through the mean effect size in order to help the visual interpretation of the effect sizes. Any value to the left of the vertical dashed line represents a negative impact of foreign pollen. The different effect sizes and confidence intervals are coloured by family: Solanaceae (orange), Brassicaceae (blue) and Convolvulaceae (green)."}

library(effsize)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(cowplot)
library(gridExtra)
library(egg)
library(magrittr)
library(multipanelfigure)
library(grid)

setwd("~/R_projects/Hp_pollen_experiment")
load("Data/RData/some_effect_size_family.RData")

pp1<- ggplot(some_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,shape=3,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  scale_fill_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  xlab("") + ylab("Cohen's d") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")



load("Data/RData/soly_effect_size_family.RData")

pp2<- ggplot(soly_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,shape=3,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  scale_fill_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  xlab("") + ylab("Cohen's d") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")


load("Data/RData/sial_effect_size_family.RData")

p3<- ggplot(sial_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,shape=3,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  scale_fill_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  xlab("") + ylab("Cohen's d") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")


load("Data/RData/pein_effect_size_family.RData")

p4<- ggplot(pein_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,shape=3,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  scale_fill_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  xlab("") + ylab("Cohen's d") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")


load("Data/RData/ippu_effect_size_family.RData")

p5<- ggplot(ippu_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,shape=3,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  scale_fill_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  xlab("") + ylab("Cohen's d") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")

load("Data/RData/ipaq_effect_size_family.RData")

p6<- ggplot(ipaq_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,shape=3,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  scale_fill_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  xlab("") + ylab("Cohen's d") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")

load("Data/RData/ersa_effect_size_family.RData")

p7<- ggplot(ersa_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,shape=3,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  scale_fill_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  xlab("") + ylab("Cohen's d") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")

load("Data/RData/caan_effect_size_family.RData")

p8<- ggplot(caan_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,shape=3,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  scale_fill_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  xlab("") + ylab("Cohen's d") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")

load("Data/RData/brra_effect_size_family.RData")

p9<- ggplot(brra_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,shape=3,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  scale_fill_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  xlab("") + ylab("Cohen's d") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")


load("Data/RData/brol_effect_size_family.RData")

p10<- ggplot(brol_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,shape=3,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  scale_fill_manual("Family",values=c("#D55E00",  "#009E73","#0072B2", "#E69F00"))+
  xlab("") + ylab("Cohen's d") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")

 #grid.arrange(p1, p5, p3, p4, nrow=2,ncol=2,top="Solanaceae")
grid.newpage()
 grid.draw(arrangeGrob(cbind(ggplotGrob(pp1),ggplotGrob(pp2), size="last"),cbind(ggplotGrob(p3),ggplotGrob(p4),size="last"),cbind(ggplotGrob(p5),ggplotGrob(p6), size="last"),cbind(ggplotGrob(p7),ggplotGrob(p8), size="last"),cbind(ggplotGrob(p9),ggplotGrob(p10), size="last"),nrow=5))
```




