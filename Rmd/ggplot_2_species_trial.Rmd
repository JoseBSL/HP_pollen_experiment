---
title: ''
output:
  pdf_document: default
  html_document: default
---
```{r,message=FALSE, warning=FALSE, echo=FALSE, cache=FALSE, fig.height=6, fig.width=7,out.width='100%'}
#Preparing seed set plots, starting with Petunia

#There are 3 crosses were seeds were lost (2,7,9)
#load libraries
library(reshape2)
library(ggplot2)
library(dplyr)
library(gridExtra)
library(grid)
library(lattice)
#read data and cleaning
pein_seed_set <- read.csv("Data/PEIN_seed_set.csv", sep=";")
#removing samples where seeds got lost, first ones of the experiment
pein_seed_set <- pein_seed_set[-c(42,47,49),]

#
##
###
#PETUNIA
###
##
#
#Removing RARA, species not considered because sterility 

pein_seed_set <- filter(pein_seed_set, Treatment!="RARA 100%" & Treatment!="RARA 50%")

#adding the focal species, first 50%
Species <- rep("PEIN", 10)
Treatment <- rep("PEIN 50%", 10)
Treatment.number <- seq(1:10)
Seed.production <- rep(0, 10)
pein_50 <- data.frame(Species,Treatment, Treatment.number, Seed.production,stringsAsFactors = F)
#adding the focal species, 100%
Species <- rep("PEIN", 10)
Treatment <- rep("PEIN 100%", 10)
Treatment.number <- seq(1:10)
Seed.production <- rep(0, 10)
pein_100<-  data.frame(Species,Treatment, Treatment.number, Seed.production,stringsAsFactors = F)
#Order from lower to higher values the average, to plot it nicely
pein_seed_set <- rbind(pein_seed_set, pein_50, pein_100)
pein_seed_set$Treatment<- as.character(pein_seed_set$Treatment)
pein_seed_set <- pein_seed_set[order(pein_seed_set$Treatment),]  
#Organizing with just 50% and cross, self, flower control and control on a side


library(stringr)
pein_seed_set_div <- str_split_fixed(as.character(pein_seed_set$Treatment), " ", 2)
pein_seed_set_div <- data.frame(pein_seed_set_div, stringsAsFactors = F)
colnames(pein_seed_set_div)=c("non_focal","percentage")
pein_seed_set_bind <- cbind(pein_seed_set,pein_seed_set_div)
pein_seed_set_bind <- filter(pein_seed_set_bind, percentage!="100%")
#Because I want to give it specifically order I do it separately
#pein_seed_set_common <- filter(pein_seed_set_bind, non_focal %in% c("CROSS", "SELF","CONTROL","FLOWER"))

pein_seed_set_cross <- filter(pein_seed_set_bind, non_focal %in% c("CROSS"))
pein_seed_set_self <- filter(pein_seed_set_bind, non_focal %in% c("SELF"))
pein_seed_set_control <- filter(pein_seed_set_bind, non_focal %in% c("CONTROL"))
pein_seed_set_flower <- filter(pein_seed_set_bind, non_focal %in% c("FLOWER"))

#Changing 0 for NA'S FOCAL species




# I HAVENT BEEN ABLE TO WORK OUT ALL AT THE SAME TIME SO i DO IOT SEPARATELY
pein_seed_set_bind=pein_seed_set_bind[pein_seed_set_bind$non_focal!=c("CROSS"),]
pein_seed_set_bind=pein_seed_set_bind[pein_seed_set_bind$non_focal!=c("SELF"),]
pein_seed_set_bind=pein_seed_set_bind[pein_seed_set_bind$non_focal!=c("CONTROL"),]
pein_seed_set_bind=pein_seed_set_bind[pein_seed_set_bind$non_focal!=c("FLOWER"),]

pein_seed_set_final<-rbind(pein_seed_set_bind,pein_seed_set_cross, pein_seed_set_self, pein_seed_set_control,
                           pein_seed_set_flower)
#deleting extra columns used for data formating
pein_seed_set_final=pein_seed_set_final[,-c(5,6)]
#adding NA'S to the focal species
pein_seed_set_final[pein_seed_set_final$Treatment==c("PEIN 50%"),4] <- NA
#changing non_focal species name
pein_seed_set_final$Treatment=as.character(pein_seed_set_final$Treatment)
pein_seed_set_final$Family[pein_seed_set_final$Treatment=="BROL 50%"] <- "Brassicaceae"
pein_seed_set_final$Family[pein_seed_set_final$Treatment=="BRRA 50%"] <- "Brassicaceae"
pein_seed_set_final$Family[pein_seed_set_final$Treatment=="SIAL 50%"] <- "Brassicaceae"
pein_seed_set_final$Family[pein_seed_set_final$Treatment=="ERSA 50%"] <- "Brassicaceae"
pein_seed_set_final$Family[pein_seed_set_final$Treatment=="SOME 50%"] <- "Solanaceae"
pein_seed_set_final$Family[pein_seed_set_final$Treatment=="SOLY 50%"] <- "Solanaceae"
pein_seed_set_final$Family[pein_seed_set_final$Treatment=="CAAN 50%"] <- "Solanaceae"
pein_seed_set_final$Family[pein_seed_set_final$Treatment=="PEIN 50%"] <- "Solanaceae"
pein_seed_set_final$Family[pein_seed_set_final$Treatment=="IPPU 50 %"] <- "Convolvulaceae"
pein_seed_set_final$Family[pein_seed_set_final$Treatment=="IPAQ 50%"] <- "Convolvulaceae"

pein_seed_set_final$Treatment[pein_seed_set_final$Treatment=="BROL 50%"] <- "Brassica oleracea"
pein_seed_set_final$Treatment[pein_seed_set_final$Treatment=="BRRA 50%"] <- "Brassica rapa"
pein_seed_set_final$Treatment[pein_seed_set_final$Treatment=="CAAN 50%"] <- "Capsicum annuum"
pein_seed_set_final$Treatment[pein_seed_set_final$Treatment=="ERSA 50%"] <- "Eruca vesicaria" #Eruca sativa seems to be a synonym
pein_seed_set_final$Treatment[pein_seed_set_final$Treatment=="IPAQ 50%"] <- "Ipomoea aquatica"
pein_seed_set_final$Treatment[pein_seed_set_final$Treatment=="IPPU 50 %"] <- "Ipomoea purpurea"
pein_seed_set_final$Treatment[pein_seed_set_final$Treatment=="PEIN 50%"] <- "Petunia integrifolia"
pein_seed_set_final$Treatment[pein_seed_set_final$Treatment=="SIAL 50%"] <- "Sinapis alba"
pein_seed_set_final$Treatment[pein_seed_set_final$Treatment=="SOLY 50%"] <- "Solanum lycopersicum"
pein_seed_set_final$Treatment[pein_seed_set_final$Treatment=="SOME 50%"] <- "Solanum melongena"

#Colur per family

a <- ggplot(pein_seed_set_final, aes(x = factor(Treatment, levels=unique(Treatment)), y = Seed.production)) +   geom_boxplot()+
  labs(title="Petunia integrifolia",x="", y = "Seeds")+aes(fill=Family)+theme(axis.text.x =element_blank())+
  theme(plot.title = element_text(hjust = 0.5)) + geom_jitter(width = 0.2) + stat_summary(fun.y=mean, geom="point", shape="*", size=5, colour="black") +theme(legend.position="none")



#
##
###
#C. ANNUUM 
###
##
#
caan_seed_set <- read.csv("Data/CAAN_seed_set.csv", sep=";")

#adding the focal species, first 50%
Species <- rep("CAAN", 10)
Treatment <- rep("CAAN 50%", 10)
Treatment.number <- seq(1:10)
Seed.production <- rep(0, 10)
caan_50 <- data.frame(Species,Treatment, Treatment.number, Seed.production)
#adding the focal species, 100%
Species <- rep("CAAN", 10)
Treatment <- rep("CAAN 100%", 10)
Treatment.number <- seq(1:10)
Seed.production <- rep(0, 10)
caan_100<-  data.frame(Species,Treatment, Treatment.number, Seed.production)
#Order from lower to higher values the average, to plot it nicely
caan_seed_set <- caan_seed_set[,-4]
colnames(caan_seed_set)[1] <- "Species"
colnames(caan_seed_set)[2] <- "Treatment"
colnames(caan_seed_set)[3] <- "Treatment.number"
colnames(caan_seed_set)[4] <- "Seed.production"
caan_seed_set <- rbind(caan_seed_set, caan_50, caan_100)
caan_seed_set$Treatment<- as.character(caan_seed_set$Treatment)
caan_seed_set <- caan_seed_set[order(caan_seed_set$Treatment),]  

#Organizing with just 50% and cross, self, flower control and control on a side

library(stringr)
caan_seed_set_div <- str_split_fixed(as.character(caan_seed_set$Treatment), " ", 2)
caan_seed_set_div <- data.frame(caan_seed_set_div, stringsAsFactors = F)
colnames(caan_seed_set_div)=c("non_focal","percentage")
caan_seed_set_bind <- cbind(caan_seed_set,caan_seed_set_div)
caan_seed_set_bind <- filter(caan_seed_set_bind, percentage!="100%")

#Because I want to give it specifically order I do it separately
#pein_seed_set_common <- filter(caan_seed_set_bind, non_focal %in% c("CROSS", "SELF","CONTROL","FLOWER"))

caan_seed_set_cross <- filter(caan_seed_set_bind, non_focal %in% c("CROSS"))
caan_seed_set_self <- filter(caan_seed_set_bind, non_focal %in% c("SELF"))
caan_seed_set_control <- filter(caan_seed_set_bind, non_focal %in% c("CONTROL"))
caan_seed_set_flower <- filter(caan_seed_set_bind, non_focal %in% c("FLOWER"))

#Changing 0 for NA'S FOCAL species




# I HAVENT BEEN ABLE TO WORK OUT ALL AT THE SAME TIME SO i DO IOT SEPARATELY
caan_seed_set_bind=caan_seed_set_bind[caan_seed_set_bind$non_focal!=c("CROSS"),]
caan_seed_set_bind=caan_seed_set_bind[caan_seed_set_bind$non_focal!=c("SELF"),]
caan_seed_set_bind=caan_seed_set_bind[caan_seed_set_bind$non_focal!=c("CONTROL"),]
caan_seed_set_bind=caan_seed_set_bind[caan_seed_set_bind$non_focal!=c("FLOWER"),]

caan_seed_set_final<-rbind(caan_seed_set_bind,caan_seed_set_cross, caan_seed_set_self, caan_seed_set_control,
                           caan_seed_set_flower)
#deleting extra columns used for data formating
caan_seed_set_final=caan_seed_set_final[,-c(5,6)]
#adding NA'S to the focal species
caan_seed_set_final[caan_seed_set_final$Treatment==c("CAAN 50%"),4] <- NA

#changing non_focal species name
caan_seed_set_final$Treatment=as.character(caan_seed_set_final$Treatment)
caan_seed_set_final$Family[caan_seed_set_final$Treatment=="BROL 50%"] <- "Brassicaceae"
caan_seed_set_final$Family[caan_seed_set_final$Treatment=="BRRA 50%"] <- "Brassicaceae"
caan_seed_set_final$Family[caan_seed_set_final$Treatment=="SIAL 50%"] <- "Brassicaceae"
caan_seed_set_final$Family[caan_seed_set_final$Treatment=="ERSA 50%"] <- "Brassicaceae"
caan_seed_set_final$Family[caan_seed_set_final$Treatment=="caan 50%"] <- "Solanaceae"
caan_seed_set_final$Family[caan_seed_set_final$Treatment=="SOLY 50%"] <- "Solanaceae"
caan_seed_set_final$Family[caan_seed_set_final$Treatment=="CAAN 50%"] <- "Solanaceae"
caan_seed_set_final$Family[caan_seed_set_final$Treatment=="PEIN 50%"] <- "Solanaceae"
caan_seed_set_final$Family[caan_seed_set_final$Treatment=="IPPU 50%"] <- "Convolvulaceae"
caan_seed_set_final$Family[caan_seed_set_final$Treatment=="IPAQ 50%"] <- "Convolvulaceae"

caan_seed_set_final$Treatment[caan_seed_set_final$Treatment=="BROL 50%"] <- "Brassica oleracea"
caan_seed_set_final$Treatment[caan_seed_set_final$Treatment=="BRRA 50%"] <- "Brassica rapa"
caan_seed_set_final$Treatment[caan_seed_set_final$Treatment=="CAAN 50%"] <- "Capsicum annuum"
caan_seed_set_final$Treatment[caan_seed_set_final$Treatment=="ERSA 50%"] <- "Eruca vesicaria" #Eruca sativa seems to be a synonym
caan_seed_set_final$Treatment[caan_seed_set_final$Treatment=="IPAQ 50%"] <- "Ipomoea aquatica"
caan_seed_set_final$Treatment[caan_seed_set_final$Treatment=="IPPU 50%"] <- "Ipomoea purpurea"
caan_seed_set_final$Treatment[caan_seed_set_final$Treatment=="PEIN 50%"] <- "Petunia integrifolia"
caan_seed_set_final$Treatment[caan_seed_set_final$Treatment=="SIAL 50%"] <- "Sinapis alba"
caan_seed_set_final$Treatment[caan_seed_set_final$Treatment=="SOLY 50%"] <- "Solanum lycopersicum"
caan_seed_set_final$Treatment[caan_seed_set_final$Treatment=="SOME 50%"] <- "Solanum melongena"


#Different colour per family
b <- ggplot(caan_seed_set_final, aes(x = factor(Treatment, levels=unique(Treatment)), y = Seed.production)) +   geom_boxplot()+
  labs(title="Capsicum annuum",x="", y = "")+aes(fill=Family)+theme(axis.text.x = element_blank())+
  theme(plot.title = element_text(hjust = 0.5)) + geom_jitter(width = 0.2) + stat_summary(fun.y=mean, geom="point", shape="*", size=5, colour="black") +theme(legend.position="none")

#
##
###
#S. LYCOPERSICUM
###
##
#


soly_seed_set <- read.csv("Data/SOLY_seed_set.csv", sep=";")
soly_seed_set <- filter(soly_seed_set, Treatment!="RARA 100%" & Treatment!="RARA 50%"& Treatment!="COSA 50%"& Treatment!="COSA 100%" )

#adding the focal species, first 50%
Species <- rep("SOLY", 10)
Treatment <- rep("SOLY 50%", 10)
Treatment.number <- seq(1:10)
Seed.production <- rep(0, 10)
soly_50 <- data.frame(Species,Treatment, Treatment.number, Seed.production)
#adding the focal species, 100%
Species <- rep("SOLY", 10)
Treatment <- rep("SOLY 100%", 10)
Treatment.number <- seq(1:10)
Seed.production <- rep(0, 10)
soly_100<-  data.frame(Species,Treatment, Treatment.number, Seed.production)
#Order from lower to higher values the average, to plot it nicely
soly_seed_set <- soly_seed_set[,-4]
colnames(soly_seed_set)[1] <- "Species"
colnames(soly_seed_set)[2] <- "Treatment"
colnames(soly_seed_set)[3] <- "Treatment.number"
colnames(soly_seed_set)[4] <- "Seed.production"
soly_seed_set <- rbind(soly_seed_set, soly_50, soly_100)
soly_seed_set$Treatment<- as.character(soly_seed_set$Treatment)
soly_seed_set <- soly_seed_set[order(soly_seed_set$Treatment),]  

#Organizing with just 50% and cross, self, flower control and control on a side

library(stringr)
soly_seed_set_div <- str_split_fixed(as.character(soly_seed_set$Treatment), " ", 2)
soly_seed_set_div <- data.frame(soly_seed_set_div, stringsAsFactors = F)
colnames(soly_seed_set_div)=c("non_focal","percentage")
soly_seed_set_bind <- cbind(soly_seed_set,soly_seed_set_div)
soly_seed_set_bind <- filter(soly_seed_set_bind, percentage!="100%")

#Because I want to give it specifically order I do it separately
#pein_seed_set_common <- filter(soly_seed_set_bind, non_focal %in% c("CROSS", "SELF","CONTROL","FLOWER"))

soly_seed_set_cross <- filter(soly_seed_set_bind, non_focal %in% c("CROSS"))
soly_seed_set_self <- filter(soly_seed_set_bind, non_focal %in% c("SELF"))
soly_seed_set_control <- filter(soly_seed_set_bind, non_focal %in% c("CONTROL"))
soly_seed_set_flower <- filter(soly_seed_set_bind, non_focal %in% c("FLOWER"))

#Changing 0 for NA'S FOCAL species




# I HAVENT BEEN ABLE TO WORK OUT ALL AT THE SAME TIME SO i DO IOT SEPARATELY
soly_seed_set_bind=soly_seed_set_bind[soly_seed_set_bind$non_focal!=c("CROSS"),]
soly_seed_set_bind=soly_seed_set_bind[soly_seed_set_bind$non_focal!=c("SELF"),]
soly_seed_set_bind=soly_seed_set_bind[soly_seed_set_bind$non_focal!=c("CONTROL"),]
soly_seed_set_bind=soly_seed_set_bind[soly_seed_set_bind$non_focal!=c("FLOWER"),]

soly_seed_set_final<-rbind(soly_seed_set_bind,soly_seed_set_cross, soly_seed_set_self, soly_seed_set_control,
                           soly_seed_set_flower)
#deleting extra columns used for data formating
soly_seed_set_final=soly_seed_set_final[,-c(5,6)]
#adding NA'S to the focal species
soly_seed_set_final[soly_seed_set_final$Treatment==c("SOLY 50%"),4] <- NA

#changing non_focal species name
soly_seed_set_final$Treatment=as.character(soly_seed_set_final$Treatment)
soly_seed_set_final$Family[soly_seed_set_final$Treatment=="BROL 50%"] <- "Brassicaceae"
soly_seed_set_final$Family[soly_seed_set_final$Treatment=="BRRA 50%"] <- "Brassicaceae"
soly_seed_set_final$Family[soly_seed_set_final$Treatment=="SIAL 50%"] <- "Brassicaceae"
soly_seed_set_final$Family[soly_seed_set_final$Treatment=="ERSA 50%"] <- "Brassicaceae"
soly_seed_set_final$Family[soly_seed_set_final$Treatment=="CAAN 50%"] <- "Solanaceae"
soly_seed_set_final$Family[soly_seed_set_final$Treatment=="SOLY 50%"] <- "Solanaceae"
soly_seed_set_final$Family[soly_seed_set_final$Treatment=="SOME 50%"] <- "Solanaceae"
soly_seed_set_final$Family[soly_seed_set_final$Treatment=="PEIN 50%"] <- "Solanaceae"
soly_seed_set_final$Family[soly_seed_set_final$Treatment=="IPPU 50%"] <- "Convolvulaceae"
soly_seed_set_final$Family[soly_seed_set_final$Treatment=="IPAQ 50%"] <- "Convolvulaceae"

soly_seed_set_final$Treatment[soly_seed_set_final$Treatment=="BROL 50%"] <- "Brassica oleracea"
soly_seed_set_final$Treatment[soly_seed_set_final$Treatment=="BRRA 50%"] <- "Brassica rapa"
soly_seed_set_final$Treatment[soly_seed_set_final$Treatment=="CAAN 50%"] <- "Capsicum annuum"
soly_seed_set_final$Treatment[soly_seed_set_final$Treatment=="ERSA 50%"] <- "Eruca vesicaria" #Eruca sativa seems to be a synonym
soly_seed_set_final$Treatment[soly_seed_set_final$Treatment=="IPAQ 50%"] <- "Ipomoea aquatica"
soly_seed_set_final$Treatment[soly_seed_set_final$Treatment=="IPPU 50%"] <- "Ipomoea purpurea"
soly_seed_set_final$Treatment[soly_seed_set_final$Treatment=="PEIN 50%"] <- "Petunia integrifolia"
soly_seed_set_final$Treatment[soly_seed_set_final$Treatment=="SIAL 50%"] <- "Sinapis alba"
soly_seed_set_final$Treatment[soly_seed_set_final$Treatment=="SOLY 50%"] <- "Solanum lycopersicum"
soly_seed_set_final$Treatment[soly_seed_set_final$Treatment=="SOME 50%"] <- "Solanum melongena"

#Different colour per family
c <- ggplot(soly_seed_set_final, aes(x = factor(Treatment, levels=unique(Treatment)), y = Seed.production)) +   geom_boxplot()+
  labs(title="Solanum lycopersicum",x="", y = "Seeds")+aes(fill=Family)+theme(axis.text.x = element_text(angle = 60, hjust = 1))+
  theme(plot.title = element_text(hjust = 0.5)) + geom_jitter(width = 0.2) + stat_summary(fun.y=mean, geom="point", shape="*", size=5, colour="black") +theme(legend.position="none")


#
##
###
#S. MELONGENA
###
##
#

#Taking out species that weren't used
some_seed_set <- read.csv("Data/SOME_seed_set.csv", sep=";")
some_seed_set <- filter(some_seed_set, Treatment!="RARA 100%" & Treatment!="RARA 50%" & Treatment!="COSA 50%" & Treatment!="COSA 100%")

#adding the focal species, first 50%
Species <- rep("SOME", 10)
Treatment <- rep("SOME 50%", 10)
Treatment.number <- seq(1:10)
Seed.production <- rep(0, 10)
some_50 <- data.frame(Species,Treatment, Treatment.number, Seed.production)
#adding the focal species, 100%
Species <- rep("SOME", 10)
Treatment <- rep("SOME 100%", 10)
Treatment.number <- seq(1:10)
Seed.production <- rep(0, 10)
some_100<-  data.frame(Species,Treatment, Treatment.number, Seed.production)
#Order from lower to higher values the average, to plot it nicely
some_seed_set<- some_seed_set[,-3]
colnames(some_seed_set)[3] <- "Treatment.number"
colnames(some_seed_set)[4] <- "Seed.production"
some_seed_set <- rbind(some_seed_set, some_50, some_100)
some_seed_set$Treatment<- as.character(some_seed_set$Treatment)
some_seed_set <- some_seed_set[order(some_seed_set$Treatment),]  

#Organizing with just 50% and cross, self, flower control and control on a side

library(stringr)
some_seed_set_div <- str_split_fixed(as.character(some_seed_set$Treatment), " ", 2)
some_seed_set_div <- data.frame(some_seed_set_div, stringsAsFactors = F)
colnames(some_seed_set_div)=c("non_focal","percentage")
some_seed_set_bind <- cbind(some_seed_set,some_seed_set_div)
some_seed_set_bind <- filter(some_seed_set_bind, percentage!="100%")

#Because I want to give it specifically order I do it separately
#pein_seed_set_common <- filter(some_seed_set_bind, non_focal %in% c("CROSS", "SELF","CONTROL","FLOWER"))

some_seed_set_cross <- filter(some_seed_set_bind, non_focal %in% c("CROSS"))
some_seed_set_self <- filter(some_seed_set_bind, non_focal %in% c("SELF"))
some_seed_set_control <- filter(some_seed_set_bind, non_focal %in% c("CONTROL"))
some_seed_set_flower <- filter(some_seed_set_bind, non_focal %in% c("FLOWER"))

#Changing 0 for NA'S FOCAL species




# I HAVENT BEEN ABLE TO WORK OUT ALL AT THE SAME TIME SO i DO IOT SEPARATELY
some_seed_set_bind=some_seed_set_bind[some_seed_set_bind$non_focal!=c("CROSS"),]
some_seed_set_bind=some_seed_set_bind[some_seed_set_bind$non_focal!=c("SELF"),]
some_seed_set_bind=some_seed_set_bind[some_seed_set_bind$non_focal!=c("CONTROL"),]
some_seed_set_bind=some_seed_set_bind[some_seed_set_bind$non_focal!=c("FLOWER"),]

some_seed_set_final<-rbind(some_seed_set_bind,some_seed_set_cross, some_seed_set_self, some_seed_set_control,
                           some_seed_set_flower)
#deleting extra columns used for data formating
some_seed_set_final=some_seed_set_final[,-c(5,6)]
#adding NA'S to the focal species
some_seed_set_final[some_seed_set_final$Treatment==c("SOME 50%"),4] <- NA

#changing non_focal species name
some_seed_set_final$Treatment=as.character(some_seed_set_final$Treatment)
some_seed_set_final$Family[some_seed_set_final$Treatment=="BROL 50%"] <- "Brassicaceae"
some_seed_set_final$Family[some_seed_set_final$Treatment=="BRRA 50%"] <- "Brassicaceae"
some_seed_set_final$Family[some_seed_set_final$Treatment=="SIAL 50%"] <- "Brassicaceae"
some_seed_set_final$Family[some_seed_set_final$Treatment=="ERSA 50%"] <- "Brassicaceae"
some_seed_set_final$Family[some_seed_set_final$Treatment=="SOME 50%"] <- "Solanaceae"
some_seed_set_final$Family[some_seed_set_final$Treatment=="SOLY 50%"] <- "Solanaceae"
some_seed_set_final$Family[some_seed_set_final$Treatment=="CAAN 50%"] <- "Solanaceae"
some_seed_set_final$Family[some_seed_set_final$Treatment=="PEIN 50%"] <- "Solanaceae"
some_seed_set_final$Family[some_seed_set_final$Treatment=="IPPU 50%"] <- "Convolvulaceae"
some_seed_set_final$Family[some_seed_set_final$Treatment=="IPAQ 50%"] <- "Convolvulaceae"

some_seed_set_final$Treatment[some_seed_set_final$Treatment=="BROL 50%"] <- "Brassica oleracea"
some_seed_set_final$Treatment[some_seed_set_final$Treatment=="BRRA 50%"] <- "Brassica rapa"
some_seed_set_final$Treatment[some_seed_set_final$Treatment=="CAAN 50%"] <- "Capsicum annuum"
some_seed_set_final$Treatment[some_seed_set_final$Treatment=="ERSA 50%"] <- "Eruca vesicaria" #Eruca sativa seems to be a synonym
some_seed_set_final$Treatment[some_seed_set_final$Treatment=="IPAQ 50%"] <- "Ipomoea aquatica"
some_seed_set_final$Treatment[some_seed_set_final$Treatment=="IPPU 50%"] <- "Ipomoea purpurea"
some_seed_set_final$Treatment[some_seed_set_final$Treatment=="PEIN 50%"] <- "Petunia integrifolia"
some_seed_set_final$Treatment[some_seed_set_final$Treatment=="SIAL 50%"] <- "Sinapis alba"
some_seed_set_final$Treatment[some_seed_set_final$Treatment=="SOLY 50%"] <- "Solanum lycopersicum"
some_seed_set_final$Treatment[some_seed_set_final$Treatment=="SOME 50%"] <- "Solanum melongena"

#Different colour per family
d <- ggplot(some_seed_set_final, aes(x = factor(Treatment, levels=unique(Treatment)), y = Seed.production)) +   geom_boxplot()+
  labs(title="Solanum melongena",x="", y = "")+aes(fill=Family)+theme(axis.text.x = element_text(angle = 60, hjust = 1))+
  theme(plot.title = element_text(hjust = 0.5)) + geom_jitter(width = 0.2) + stat_summary(fun.y=mean, geom="point", shape="*", size=5, colour="black") +theme(legend.position="none")

gl <- lapply(list(a,b,c,d), ggplotGrob)
library(grid)
widths <- do.call(unit.pmax, lapply(gl, "[[", "widths"))
heights <- do.call(unit.pmax, lapply(gl, "[[", "heights"))
lg <- lapply(gl, function(g) {g$widths <- widths; g$heights <- heights; g})



grobz <- lapply(list(a, b, c, d), ggplotGrob)
grobz.plot <- arrangeGrob( grobs = list(rbind(grobz[[1]], grobz[[3]], size = "last"),
                                        rbind(grobz[[2]], grobz[[4]], size = "last")),
                           ncol = 2, top="b")

grid.draw(grobz.plot)

```

