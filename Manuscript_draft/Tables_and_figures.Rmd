---
output:
  pdf_document: default
  html_document: default
  fontsize: 11pt
header-includes:
  - \usepackage{leading}
  - \leading{18pt}
---
--
```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.pos = "h")
```

```{r setup, include=FALSE, cache=FALSE, message = FALSE}

library("knitr")
library("ggplot2")
library("extrafont")

#opts_knit$set(root.dir=normalizePath('../'))

### Chunk options: see http://yihui.name/knitr/options/ ###

## Text results
opts_chunk$set(echo = TRUE, warning = TRUE, message = TRUE, include = TRUE)

## Code decoration
opts_chunk$set(tidy = TRUE, comment = NA, highlight = TRUE)

## Cache
opts_chunk$set(cache = 2, cache.path = "output/cache/")

## Plots
opts_chunk$set(fig.path = "output/figures/")


```


```{r knitcitations, echo=FALSE, cache = FALSE}
library(knitcitations)
cleanbib()   
cite_options(citation_format = "pandoc")
```

**Table 1**
```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE}
library(kableExtra)
Family <- c(rep("Brassicaceae",4), rep("Convolvulaceae", 2), rep("Solanaceae",4))

Genus <- c("Brassica", "Brassica", "Eruca", "Sinapis", "Ipomoea", "Ipomoea", "Capsicum", "Petunia", "Solanum", "Solanum")

Species <- c("Brassica rapa", "Brassica oleracea", "Eruca versicaria", "Sinapis alba", "Ipomoea aquatica", "Ipomoea purpurea", "Capsicum annuum", "Petunia integrifolia", "Solanum lycopersicum", "Solanum melongena")

table<- data.frame(Family, Genus, Species)
kable(table, format="markdown", caption = "a")
```
\newpage
```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE, out.width='100%'}
knitr::include_graphics('images/phylo_image.png')
```
**Figure 1**
\newpage
```{r, echo=FALSE,fig.align='center',message=FALSE, warning=FALSE, cache=FALSE,fig.height=4,fig.width=7}
load("r_biology.RData")
library(ggpubr)
library(cowplot)
library(gridExtra)
library(egg)
library(magrittr)
library(multipanelfigure)
library(grid)
ggplot(bio,aes(x=Species,y=value,fill=variable))+
  geom_bar(stat="identity",position="dodge")+scale_fill_grey(start = 0, end = 0.85,name="Treatments") + 
  theme_minimal()+xlab("Species")+ylab("Seed-setting rate (%)")+labs(title="Reproductive biology test")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1, face= "italic",family = ""), legend.text=element_text(size=7), legend.title=element_text(size=8), axis.text.y  = element_text(size = 10))+
  scale_y_continuous(minor_breaks = seq(0 , 100, 5), breaks = seq(0, 100, 10))

```
**Figure 2**

\newpage
```{r, echo=FALSE, message=FALSE,fig.align='center', warning=FALSE,cache=FALSE,fig.height=2.5,fig.width=6}

library(effsize)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(cowplot)
library(gridExtra)
library(egg)
library(magrittr)
library(multipanelfigure)
library(grid)

load("effect_size_species/effect_size_total.RData")

 ggplot(all, aes(Family,Cohen_d,colour=Family_1), size=10) + theme_bw(base_size=10)+theme(axis.text.y = element_text(face = "italic"))+ geom_point( aes(colour=Family_1),size=2) +
  geom_errorbar(aes(x = Family, ymin = Lower, 
ymax = Upper,colour=Family_1), width = 0.2, size=0.8, alpha=0.5)+
  scale_color_manual(name  ="Family",values=c( "#0072B2", "#009E73", "#D55E00"), labels=c("Solanaceae", "Convolvulaceae","Brassicaceae"))+
  scale_fill_manual(name  ="Family",values=c( "#0072B2", "#009E73", "#D55E00"), labels=c("Solanaceae", "Convolvulaceae","Brassicaceae"))+
  xlab("") + ylab("Hedges' g") + rotate()+
  geom_hline(yintercept=0, linetype="dashed", color = "black")+scale_alpha(guide = 'none')
```
**Figure 3**

\newpage
```{r, echo=FALSE, message=FALSE, warning=FALSE,fig.margin = TRUE,cache=FALSE,fig.height=9,fig.width=7}

library(effsize)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(cowplot)
library(gridExtra)
library(egg)
library(magrittr)
library(multipanelfigure)
library(grid)

load("effect_size_species/all_effect_size.RData")

#BROL
load("effect_size_species/brol_effect_size.RData")
p1<- ggplot(brol_effect_size, aes(Species_1,Cohen_d, size=10)) + theme_bw(base_size=10)+theme(plot.title=element_text(size=10),title = element_text(vjust=2),axis.text.y = element_text(size=5,face = c('italic', 'italic', 'italic', 'italic', 'italic','italic', 'italic', 'italic', 'italic', 'italic')),plot.margin = unit(c(0,0.3,0,1), "cm"))+geom_point(alpha=c(1,1,1,1,1,1,1,1,1,1),size=1.5,aes(color=factor(Species_1))) +geom_errorbar(alpha=c(0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5),size=0.4,show.legend=FALSE, aes(x = Species_1, ymin = Lower, ymax = Upper,color=factor(Species_1)))+scale_color_manual("Species_1",values=c(rep("#D55E00",4), rep("#009E73",2), rep("#0072B2",3),"#E69F00"))+
  scale_fill_manual("Species_1",values=c(rep("#D55E00",4), rep("#009E73",2), rep("#0072B2",4)))+
  xlab("") + ylab("") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")+annotate("text", x=10, y=-6, label= "")+ggtitle(substitute(paste("A)",italic(' B. oleracea')))) 

#BRRA
load("effect_size_species/brra_effect_size.RData")
pp2<- ggplot(brra_effect_size, aes(Species_1,Cohen_d, size=10)) + theme_bw(base_size=10)+theme(plot.title = element_text(size = 10),plot.margin = unit(c(0,0,0,0), "cm"),axis.text.y = element_blank())+ geom_point(alpha=c(1,1,1,1,1,1,1,1,1,1),size=1.5,show.legend = FALSE,aes(color=factor(Species_1))) +geom_errorbar(alpha=0.5,size=0.4,show.legend=FALSE, aes(x = Species_1, ymin = Lower, ymax = Upper,color=factor(Species_1)))+scale_color_manual("Species_1",values=c(rep("#D55E00",4), rep("#009E73",2), rep("#0072B2",2),"#E69F00","#0072B2"))+
  scale_fill_manual("Species_1",values=c(rep("#D55E00",4), rep("#009E73",2), rep("#0072B2",4)))+
  xlab("") + ylab("") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")+annotate("text", x=10, y=-6, label= "")+ggtitle(substitute(paste("B)",italic(' B. rapa')))) 


#ERSA
load("effect_size_species/ersa_effect_size.RData")
p3<- ggplot(ersa_effect_size, aes(Species_1,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(alpha=c(1,1,1,1,1,1,1,1,1,1),size=1.5,show.legend = FALSE,aes(color=factor(Species_1))) +geom_errorbar(alpha=0.5,size=0.4,show.legend=FALSE, aes(x = Species_1, ymin = Lower, ymax = Upper,color=factor(Species_1)))+scale_color_manual("Species_1",values=c(rep("#D55E00",4), rep("#009E73",2), rep("#0072B2",1),"#E69F00", rep("#0072B2",3)))+
  scale_fill_manual("Species_1",values=c(rep("#D55E00",4), rep("#009E73",2), rep("#0072B2",4)))+
  xlab("") + ylab("") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")+theme(plot.title = element_text(size = 10),plot.margin = unit(c(0,0.3,0,1), "cm"),axis.text.y = element_text(size=5,face = c('italic', 'italic', 'italic', 'italic','italic','italic', 'italic', 'italic', 'italic', 'italic')))+ggtitle(substitute(paste("C)",italic(' E. sativa')))) 


#SIAL
load("effect_size_species/sial_effect_size.RData")
p4<- ggplot(sial_effect_size, aes(Species_1,Cohen_d, size=10)) + theme_bw(base_size=10)+theme(plot.title = element_text(size = 10),plot.margin = unit(c(0,0,0,0), "cm"),axis.text.y = element_blank())+ geom_point(alpha=c(1,1,1,1,1,1,1,1,1,1),size=1.5,show.legend = FALSE,aes(color=factor(Species_1))) +geom_errorbar(alpha=0.5,size=0.4,show.legend=FALSE, aes(x = Species_1, ymin = Lower, ymax = Upper,color=factor(Species_1)))+scale_color_manual("Species_1",values=c(rep("#D55E00",4), rep("#009E73",2),"#E69F00", rep("#0072B2",3)))+
  scale_fill_manual("Species_1",values=c(rep("#D55E00",4), rep("#009E73",2), rep("#0072B2",4)))+
  xlab("") + ylab("") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")+ggtitle(substitute(paste("D)",italic(' S. alba')))) 

#IPAQ
load("effect_size_species/ipaq_effect_size.RData")
p5<- ggplot(ipaq_effect_size, aes(Species_1,Cohen_d, size=10)) + theme_bw(base_size=10)+theme(plot.title = element_text(size = 10),axis.text.y = element_text(size=5,face = c('italic', 'italic', 'italic', 'italic','italic','italic', 'italic', 'italic', 'italic', 'italic')),plot.margin = unit(c(0,0.3,0,1), "cm"))+geom_point(alpha=c(1,1,1,1,1,1,1,1,1,1),size=1.5,show.legend = FALSE,aes(color=factor(Species_1))) +geom_errorbar(alpha=0.5,size=0.4,show.legend=FALSE, aes(x = Species_1, ymin = Lower, ymax = Upper,color=factor(Species_1)))+scale_color_manual("Species_1",values=c(rep("#D55E00",4), rep("#009E73",1),"#E69F00", rep("#0072B2",4)))+
  scale_fill_manual("Species_1",values=c("#D55E00", "#009E73", "#0072B2"))+
  xlab("") + ylab("") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")+ggtitle(substitute(paste("E)",italic(' I. aquatica')))) 

#IPPU
load("effect_size_species/ippu_effect_size.RData")
p6<- ggplot(ippu_effect_size, aes(Species_1,Cohen_d, size=10)) + theme_bw(base_size=10)+
  theme(plot.title = element_text(size = 10),plot.margin = unit(c(0,0,0,0), "cm"),axis.text.y = element_blank())+geom_point(alpha=c(1,1,1,1,1,1,1,1,1,1),size=1.5,show.legend = FALSE,aes(color=factor(Species_1))) +geom_errorbar(alpha=0.5,size=0.4,show.legend=FALSE, aes(x = Species_1, ymin = Lower, ymax = Upper,color=factor(Species_1)))+scale_color_manual("Species_1",values=c(rep("#D55E00",4),"#E69F00", rep("#009E73",1), rep("#0072B2",4)))+
  scale_fill_manual("Species_1",values=c("#D55E00", "#009E73", "#0072B2"))+
  xlab("") + ylab("") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")+ggtitle(substitute(paste("F)",italic(' I. purpurea')))) 

#CAAN
load("effect_size_species/caan_effect_size.RData")
p7<- ggplot(caan_effect_size, aes(Species_1,Cohen_d, size=10)) + theme_bw(base_size=10)+theme(plot.title = element_text(size = 10),plot.margin = unit(c(0,0.3,0,1), "cm"),axis.text.y = element_text(size=5,face = c('italic', 'italic', 'italic', 'italic', 'italic','italic', 'italic', 'italic', 'italic', 'italic')))+ geom_point(alpha=c(1,1,1,1,1,1,1,1,1,1),size=1.5,show.legend = FALSE,aes(color=factor(Species_1))) +geom_errorbar(alpha=0.5,size=0.4,show.legend=FALSE, aes(x = Species_1, ymin = Lower, ymax = Upper,color=factor(Species_1)))+scale_color_manual("Species_1",values=c(rep("#D55E00",3),"#E69F00", rep("#009E73",2), rep("#0072B2",4)))+
  scale_fill_manual("Species_1",values=c(rep("#D55E00",3),"#E69F00", rep("#009E73",2), rep("#0072B2",4)))+
  xlab("") + ylab("") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")+ggtitle(substitute(paste("G)",italic(' C. annuum')))) 

#PEIN
load("effect_size_species/pein_effect_size.RData")
p8<- ggplot(pein_effect_size, aes(Species_1,Cohen_d, size=10)) + theme_bw(base_size=10)+theme(plot.title = element_text(size = 10),axis.text.y = element_blank(),plot.margin = unit(c(0,0,0,0), "cm"))+ geom_point(alpha=c(1,1,1,1,1,1,1,1,1,1),size=1.5,show.legend = FALSE,aes(color=factor(Species_1))) +geom_errorbar(alpha=0.5,size=0.4,show.legend=FALSE, aes(x = Species_1, ymin = Lower, ymax = Upper,color=factor(Species_1)))+scale_color_manual("Species_1",values=c(rep("#D55E00",2),"#E69F00","#D55E00", rep("#009E73",2), rep("#0072B2",4)))+
  scale_fill_manual("Species_1",values=c(rep("#D55E00",2),"#E69F00","#D55E00", rep("#009E73",2), rep("#0072B2",4)))+
  xlab("") + ylab("") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")+ggtitle(substitute(paste("H)",italic(' P. integrifolia')))) 

#SOLY
load("effect_size_species/soly_effect_size.RData")
p9<- ggplot(soly_effect_size, aes(Species_1,Cohen_d, size=10)) + theme_bw(base_size=10)+theme(plot.title = element_text(size = 10),axis.text.y = element_text(size=5,face = c('italic', 'italic', 'italic', 'italic', 'italic','italic', 'italic', 'italic', 'italic', 'italic')),plot.margin = unit(c(0,0.3,0,1), "cm"))+ geom_point(alpha=c(1,1,1,1,1,1,1,1,1,1),size=1.5,show.legend = FALSE,aes(color=factor(Species_1))) +geom_errorbar(alpha=0.5,size=0.4,show.legend=FALSE, aes(x = Species_1, ymin = Lower, ymax = Upper,color=factor(Species_1)))+scale_color_manual("Species_1",values=c(rep("#D55E00",1),"#E69F00",rep("#D55E00",2), rep("#009E73",2), rep("#0072B2",4)))+scale_fill_manual("Species_1",values=c("#D55E00", "#009E73", "#0072B2"))+
  xlab("") + ylab("Hedges' g") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")+ggtitle(substitute(paste("I)",italic(' S. lycopersicum')))) 

#SOME
load("effect_size_species/some_effect_size.RData")

p10<- ggplot(some_effect_size, aes(Species_1,Cohen_d, size=10)) + theme_bw(base_size=10)+theme(plot.title = element_text(size = 10),plot.margin = unit(c(0,0,0,0), "cm"),axis.text.y = element_blank())+ geom_point(size=1.5,alpha=c(1,1,1,1,1,1,1,1,1,1),show.legend = FALSE,aes(color=factor(Species_1))) +geom_errorbar(size=0.6,alpha=0.4,show.legend=FALSE, aes(x = Species_1, ymin = Lower, ymax = Upper,color=factor(Species_1)))+scale_color_manual("Species_1",values=c("#E69F00",rep("#D55E00",3), rep("#009E73",2), rep("#0072B2",4)))+
  scale_fill_manual("Species_1",values=c("#D55E00", "#009E73", "#0072B2"))+
  xlab("") + ylab("Hedges' g") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")+ggtitle(substitute(paste("J)",italic(' S. melongena')))) 

sp_legend <- readRDS("Data/sp_legend.RData")
p11<- ggplot(sp_legend, aes(Species_1,Cohen_d, size=10)) + theme_bw(base_size=10)+theme(legend.direction="horizontal",legend.title = element_blank(),plot.margin = unit(c(0,0,0,0.3), "cm"),axis.text.y = element_blank())+ geom_point(size=2,alpha=c(1,1,1,1,1,1,1,1,1,1),aes(color=factor(Family))) +geom_errorbar(size=0.6,alpha=0.5, aes(x = Family, ymin = Lower, ymax = Upper,color=factor(Family)))+scale_color_manual("Family",values=c("#D55E00","#009E73","#E69F00","#0072B2"))+ scale_fill_manual("Family",values=c("#D55E00", "#009E73", "#0072B2","#0072B2"))+
  xlab("") + ylab("Hedges' g") +geom_hline(yintercept=0, linetype="dashed", color = "black")+ggtitle(substitute(paste("J)",italic(' S. melongena')))) 
 #grid.arrange(p1, p5, p3, p4, nrow=2,ncol=2,top="Solanaceae")
grid.newpage()

g_legend<-function(a.gplot){
  tmp <- ggplot_gtable(ggplot_build(a.gplot))
  leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
  legend <- tmp$grobs[[leg]]
  return(legend)}

mylegend<-g_legend(p11)

 grid.draw(arrangeGrob(cbind(ggplotGrob(p1+theme(legend.position="none")),ggplotGrob(pp2+theme(legend.position="none")), size="last"),cbind(ggplotGrob(p3+theme(legend.position="none")),ggplotGrob(p4+theme(legend.position="none")),size="last"),cbind(ggplotGrob(p5+theme(legend.position="none")),ggplotGrob(p6+theme(legend.position="none")), size="last"),cbind(ggplotGrob(p7+theme(legend.position="none")),ggplotGrob(p8+theme(legend.position="none")), size="last"),cbind(ggplotGrob(p9+theme(legend.position="none")),ggplotGrob(p10+theme(legend.position="none")),size="last"),mylegend,nrow=6))
#mylegend
```
**Figure 4**

\newpage
```{r, echo=FALSE, message=FALSE,warning=FALSE,cache=FALSE,fig.height=8,fig.width=7}
library(effsize)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(cowplot)
library(gridExtra)
library(egg)
library(magrittr)
library(multipanelfigure)
library(grid)
library(tidyverse)


load("effect_size_species/some_effect_size_family.RData")

pp1<- ggplot(some_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,aes(color=factor(Family))) + theme(legend.title = element_blank(),legend.direction="horizontal")+
  geom_linerange(size=0.6,linetype=1, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#0072B2",  "#009E73", "#D55E00","#E69F00"))+
  scale_fill_manual("Family",values=c("#E69F00", "#0072B2", "#009E73", "#D55E00"))+
  xlab("") + ylab("") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")



load("effect_size_species/soly_effect_size_family.RData")

pp2<- ggplot(soly_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#0072B2",  "#009E73", "#D55E00","#E69F00"))+
  scale_fill_manual("Family",values=c("#E69F00", "#0072B2", "#009E73", "#D55E00"))+
  xlab("") + ylab("") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")


load("effect_size_species/sial_effect_size_family.RData")

p3<- ggplot(sial_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#0072B2",  "#009E73", "#D55E00","#E69F00"))+
  scale_fill_manual("Family",values=c("#E69F00", "#0072B2", "#009E73", "#D55E00"))+
  xlab("") + ylab("") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")


load("effect_size_species/pein_effect_size_family.RData")

p4<- ggplot(pein_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#0072B2",  "#009E73", "#D55E00","#E69F00"))+
  scale_fill_manual("Family",values=c("#E69F00", "#0072B2", "#009E73", "#D55E00"))+
  xlab("") + ylab("") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")


load("effect_size_species/ippu_effect_size_family.RData")

p5<- ggplot(ippu_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#0072B2",  "#009E73", "#D55E00","#E69F00"))+
  scale_fill_manual("Family",values=c("#E69F00", "#0072B2", "#009E73", "#D55E00"))+
  xlab("") + ylab("") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")

load("effect_size_species/ipaq_effect_size_family.RData")

p6<- ggplot(ipaq_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#0072B2",  "#009E73", "#D55E00","#E69F00"))+
  scale_fill_manual("Family",values=c("#E69F00", "#0072B2", "#009E73", "#D55E00"))+
  xlab("") + ylab("") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")

load("effect_size_species/ersa_effect_size_family.RData")

p7<- ggplot(ersa_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#0072B2",  "#009E73", "#D55E00","#E69F00"))+
  scale_fill_manual("Family",values=c("#E69F00", "#0072B2", "#009E73", "#D55E00"))+
  xlab("") + ylab("") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")

load("effect_size_species/caan_effect_size_family.RData")

p8<- ggplot(caan_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#0072B2",  "#009E73", "#D55E00","#E69F00"))+
  scale_fill_manual("Family",values=c("#E69F00", "#0072B2", "#009E73", "#D55E00"))+
  xlab("") + ylab("") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")

load("effect_size_species/brra_effect_size_family.RData")

p9<- ggplot(brra_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#0072B2",  "#009E73", "#D55E00","#E69F00"))+
  scale_fill_manual("Family",values=c("#E69F00", "#0072B2", "#009E73", "#D55E00"))+
  xlab("") + ylab("Hedges' g") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")


load("effect_size_species/brol_effect_size_family.RData")

p10<- ggplot(brol_effect_size, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+ geom_point(size=2,show.legend = FALSE,aes(color=factor(Family))) +
  geom_linerange(size=0.6,linetype=1,show.legend=FALSE, aes(x = Family, ymin = Lower, 
ymax = Upper,color=factor(Family)))+
  scale_color_manual("Family",values=c("#0072B2",  "#009E73", "#D55E00","#E69F00"))+
  scale_fill_manual("Family",values=c("#E69F00", "#0072B2", "#009E73", "#D55E00"))+
  xlab("") + ylab("Hedges' g") + rotate(ylim = c(-6, 2))+guides(fill=FALSE)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")

 #grid.arrange(p1, p5, p3, p4, nrow=2,ncol=2,top="Solanaceae")
grid.newpage()
g_legend<-function(a.gplot){
  tmp <- ggplot_gtable(ggplot_build(a.gplot))
  leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
  legend <- tmp$grobs[[leg]]
  return(legend)}
leg_family=readRDS("Data/leg_family.RData")
p11<- ggplot(leg_family, aes(Family,Cohen_d, size=10)) + theme_bw(base_size=10)+theme(legend.direction="horizontal",legend.title = element_blank(),axis.text.y = element_blank())+ geom_point(size=2,aes(color=factor(Family))) +geom_errorbar(size=0.6,alpha=0.5, aes(x = Family, ymin = Lower, ymax = Upper,color=factor(Family)))+scale_color_manual("Family",values=c("#D55E00","#009E73","#E69F00","#0072B2"))
 #grid.arrange(p1, p5, p3, p4, nrow=2,ncol=2,top="Solanaceae")
mylegend<-g_legend(p11)

 grid.draw(arrangeGrob(cbind(ggplotGrob(pp1+theme(legend.position="none")),ggplotGrob(pp2+theme(legend.position="none")), size="last"),cbind(ggplotGrob(p3+theme(legend.position="none")),ggplotGrob(p4+theme(legend.position="none")),size="last"),cbind(ggplotGrob(p5+theme(legend.position="none")),ggplotGrob(p6+theme(legend.position="none")), size="last"),cbind(ggplotGrob(p7+theme(legend.position="none")),ggplotGrob(p8+theme(legend.position="none")), size="last"),cbind(ggplotGrob(p9+theme(legend.position="none")),ggplotGrob(p10+theme(legend.position="none")), size="last"),mylegend,nrow=6))
 

```
**Figure 5**

\newpage
```{r, echo=FALSE,fig.align='center', message=FALSE,warning=FALSE,cache=FALSE}
library(ape)
library(phylosignal)
library(adephylo)
library(phylobase)
library(phylosignal)
library(caret)
library(ggplot2)
library(seqHMM)
library(dplyr)
library(reshape2)
pollen_tree=read.tree("Data/pollen_tree_no_outgroup.nwk")
effect_size_all <- readRDS( "Data/effect_size_all.RData")
#Now rename species
rownames(effect_size_all) <- c("Solanum_melongena","Solanum_lycopersicum","Petunia_integrifolia", "Capsicum_annuum","Ipomoea_purpurea","Ipomoea_aquatica","Sinapis_alba","Eruca_vesicaria","Brassica_rapa", "Brassica_oleracea")
hp_mean_sp=effect_size_all[,-c(1,3,4)]
p4d <- phylo4d(pollen_tree, hp_mean_sp)
barplot.phylo4d(p4d, center = TRUE , scale = FALSE,trait.labels="Hp effect",bar.col = c(rep("#0072B2",4), rep("#009E73",2), rep("#D55E00",4)))
```
**Figure 6**


\newpage
```{r, echo=FALSE,fig.align='center',message=FALSE, warning=FALSE, cache=FALSE, fig.height=3,fig.width=5}
load("Data/family_cor.RData")
library(ggpubr)
library(ggplot2)
library(gridExtra)
library(grid)

p1 <- ggscatter(sola, x = "Cohen_d", y = "style_length", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson",
          xlab = "Hedges' g", ylab = "Style length (mm)", main="A) Solanaceae")

p2<- ggscatter(a, x = "Cohen_d", y = "style_length", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson",
          xlab = "Hedges' g", ylab = "Style length (mm)", main="A) All families")
grid.arrange(p1, p2, nrow = 1, ncol=2)



```
**Figure 7**


\newpage
```{r, echo=FALSE,fig.align='center',message=FALSE, warning=FALSE, cache=FALSE,fig.height=9,fig.width=5}
load("pollen_ratio.RData")
library(ggpubr)
library(ggplot2)
library(gridExtra)
library(grid)

p1 <- ggplot(pollen_ratios_brassicaceae, aes(x=spp, y=ratio, fill=variable)) +
  geom_bar(stat='identity', position='dodge') +labs(title="A) Brassicaceae") +
  theme(axis.text.x=element_text(size = 8,angle=45,hjust=1, face="italic"), legend.title = element_blank()) + scale_fill_grey(labels=c("Recipient","Donor")) + 
  geom_hline(yintercept = 50) + xlab("") + ylab("Pollen Ratio")

p2 <- ggplot(pollen_ratios_solanaceae, aes(x=spp, y=ratio, fill=variable)) +
  geom_bar(stat='identity', position='dodge') +labs(title="B) Solanaceae") +
  theme(axis.text.x=element_text(size = 8,angle=45,hjust=1, face="italic"), legend.title = element_blank()) + scale_fill_grey(labels=c("Recipient","Donor")) + 
  geom_hline(yintercept = 50) + xlab("") + ylab("Pollen Ratio")

p3 <-ggplot(pollen_ratios_convolvulaceae, aes(x=spp, y=ratio, fill=variable)) +
  geom_bar(stat='identity', position='dodge') +labs(title="C) Convolvulaceae") +
  theme(axis.text.x=element_text(size = 8,angle=45,hjust=1, face="italic"), legend.title = element_blank()) + scale_fill_grey(labels=c("Recipient","Donor")) + 
  geom_hline(yintercept = 50) + xlab("") + ylab("Pollen Ratio")
grid.arrange(p1, p2,p3, nrow = 3, ncol=1)



```
**Figure 8**

\newpage
```{r, echo=FALSE,fig.align='center',message=FALSE, warning=FALSE, cache=FALSE,fig.height=9,fig.width=5}
load("Data/total_pollen.RData")
library(ggpubr)
library(ggplot2)
library(gridExtra)
library(grid)

p1 <- ggplot(total_pollen_brassicaceae, aes(x=spp, y=ratio, fill=variable)) +
  geom_bar(stat='identity', position='dodge') +labs(title="A) Brassicaceae") +
  theme(axis.text.x=element_text(size = 8,angle=45,hjust=1, face="italic"), legend.title = element_blank()) + scale_fill_grey(labels=c("Recipient","Donor"))+ xlab("") + ylab("Total pollen")

p2 <- ggplot(total_pollen_solanaceae, aes(x=spp, y=ratio, fill=variable)) +
  geom_bar(stat='identity', position='dodge') +labs(title="B) Solanaceae") +
  theme(axis.text.x=element_text(size = 8,angle=45,hjust=1, face="italic"), legend.title = element_blank()) + scale_fill_grey(labels=c("Recipient","Donor"))+ xlab("") + ylab("Total pollen")

p3 <-ggplot(pollen_ratios_convolvulaceae, aes(x=spp, y=ratio, fill=variable)) +
  geom_bar(stat='identity', position='dodge') +labs(title="C) Convolvulaceae") +
  theme(axis.text.x=element_text(size = 8,angle=45,hjust=1, face="italic"), legend.title = element_blank()) + scale_fill_grey(labels=c("Recipient","Donor"))+ xlab("") + ylab("Total pollen")
grid.arrange(p1, p2,p3, nrow = 3, ncol=1)



```
**Figure 9**

\newpage

# List of tables

**Table 1** Species list with family and genus.

# List of figures

**Figure 1** Phylogenetic tree of the species used in the experiment from three different families from top to bottom: Brassicaceae, Convolvulaceae and Solanaceae.

**Figure 2** Barplot of the different tests of the reproductive biology of the species. The y axis is the percentage of ovules converted to seed. The different treatments are, hand cross-pollination, hand self-pollination, natural selfing and apomixis (N=10 for all of them).

**Figure 3** The impact of foreign pollen on recipient plant species. Effect sizes (with 95% confidence intervals) of 9 different donor species of heterospecific pollen upon all recipients.

**Figure 4** The response of heterospecific pollen upon 10 recipient plant species.  Each panel represents one recipient plant species crossed with 50% mixes of the other 9 species.

**Figure 5**

**Figure 6** Phylogenetic signal of hterospecific pollen effect (hedges' g)

**Figure 7** (comment) Simple Pearson correlation in order to show a possible path to follow in the article showing that style length and stigma size could explain the effect in Solanaceae species.

**Figure 8** Pollen ratio counts on stigma after hand pollination with 50-50% mix. The panel is divided by family: A) Brassicaceae, B) Solanaceae and C) Convolvulaceae. The pollen recipient species is coloured in black and the donor species in grey.

**Figure 9** Total pollen counts on stigma after hand pollination with 50-50% mix. The panel is divided by family: A) Brassicaceae, B) Solanaceae and C) Convolvulaceae. The pollen recipient species is coloured in black and the donor species in grey.
